<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 5 &mdash; Working with Windows and CLI Systems</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700;900&family=Source+Sans+3:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap');
:root{--bg0:#F4F0EB;--bg1:#FFFFFF;--bg2:#EDE7E0;--tx0:#1A1A2E;--tx1:#4A4A5A;--tx2:#7A7A8A;--ac:#0D5C63;--ac2:#14919B;--acG:rgba(13,92,99,.12);--hi:#C44536;--hi2:#E76F51;--ok:#2D6A4F;--ok2:#52B788;--warn:#E9C46A;--bdr:#D5CEC7;--shd:0 2px 16px rgba(26,26,46,.06);--shd2:0 8px 32px rgba(26,26,46,.12);--r:12px;--rs:8px;--t:.3s cubic-bezier(.4,0,.2,1);--fH:'Merriweather',Georgia,serif;--fB:'Source Sans 3','Segoe UI',sans-serif;--fM:'JetBrains Mono','Courier New',monospace}
[data-theme="dark"]{--bg0:#0F1419;--bg1:#1A2028;--bg2:#242D38;--tx0:#E8E6E3;--tx1:#B0ADA8;--tx2:#7A7872;--ac:#14919B;--ac2:#44C7D0;--acG:rgba(20,145,155,.15);--hi:#E76F51;--hi2:#F4A261;--ok:#52B788;--ok2:#95D5B2;--bdr:#2E3A47;--shd:0 2px 16px rgba(0,0,0,.3);--shd2:0 8px 32px rgba(0,0,0,.5)}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}html{scroll-behavior:smooth;font-size:16px}body{font-family:var(--fB);background:var(--bg0);color:var(--tx0);line-height:1.7;transition:background var(--t),color var(--t)}
.skip-link{position:absolute;top:-100%;left:50%;transform:translateX(-50%);background:var(--ac);color:#fff;padding:12px 24px;border-radius:0 0 var(--rs) var(--rs);z-index:10000;font-weight:600;text-decoration:none;transition:top .2s}.skip-link:focus{top:0}
::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:var(--bg2)}::-webkit-scrollbar-thumb{background:var(--ac);border-radius:4px}
.hero{background:linear-gradient(135deg,#0D5C63 0%,#14919B 50%,#0D5C63 100%);padding:60px 24px 50px;text-align:center;position:relative;overflow:hidden}.hero::before{content:'';position:absolute;inset:0;background:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")}.hero-badge{display:inline-block;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.25);padding:6px 20px;border-radius:50px;font-family:var(--fM);font-size:.8rem;color:rgba(255,255,255,.9);letter-spacing:2px;text-transform:uppercase;margin-bottom:20px;position:relative}.hero h1{font-family:var(--fH);font-size:clamp(1.8rem,4vw,2.8rem);font-weight:900;color:#fff;line-height:1.3;max-width:800px;margin:0 auto 12px;position:relative}.hero p{font-size:1.1rem;color:rgba(255,255,255,.85);max-width:620px;margin:0 auto;position:relative}
.progress-container{position:sticky;top:0;z-index:1000;background:var(--bg1);border-bottom:1px solid var(--bdr);padding:10px 24px;display:flex;align-items:center;gap:16px;transition:background var(--t)}.progress-bar-wrap{flex:1;height:8px;background:var(--bg2);border-radius:4px;overflow:hidden}.progress-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--ac),var(--ac2));border-radius:4px;transition:width .5s ease}.progress-text{font-family:var(--fM);font-size:.8rem;color:var(--tx2);min-width:42px;text-align:right}.theme-toggle{background:var(--bg2);border:1px solid var(--bdr);border-radius:50px;padding:6px 14px;cursor:pointer;font-size:1.1rem;color:var(--tx0);transition:all var(--t);display:flex;align-items:center;gap:6px}.theme-toggle:hover,.theme-toggle:focus-visible{background:var(--ac);color:#fff}
.nav-bar{background:var(--bg1);border-bottom:1px solid var(--bdr);padding:0 24px;display:flex;overflow-x:auto;gap:4px;scrollbar-width:none;transition:background var(--t)}.nav-bar::-webkit-scrollbar{display:none}.nav-btn{background:none;border:none;padding:14px 18px;font-family:var(--fB);font-size:.85rem;font-weight:600;color:var(--tx2);cursor:pointer;white-space:nowrap;border-bottom:3px solid transparent;transition:all var(--t)}.nav-btn:hover,.nav-btn:focus-visible{color:var(--ac)}.nav-btn.active{color:var(--ac);border-bottom-color:var(--ac)}
.container{max-width:960px;margin:0 auto;padding:32px 24px 80px}.section{display:none;animation:fadeIn .4s ease}.section.active{display:block}@keyframes fadeIn{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}h2{font-family:var(--fH);font-size:1.8rem;font-weight:900;color:var(--tx0);margin-bottom:8px;display:flex;align-items:center;gap:12px}h2 .icon{font-size:1.4rem}.section-sub{color:var(--tx2);font-size:1rem;margin-bottom:28px}h3{font-family:var(--fH);font-size:1.2rem;font-weight:700;margin:24px 0 12px;color:var(--tx0)}
.card{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--r);padding:24px;margin-bottom:16px;box-shadow:var(--shd);transition:all var(--t)}
.obj-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-top:20px}.obj-card{background:var(--bg1);border:1px solid var(--bdr);border-left:4px solid var(--ac);border-radius:var(--rs);padding:20px;display:flex;align-items:flex-start;gap:14px;box-shadow:var(--shd);transition:all var(--t)}.obj-card:hover{border-left-color:var(--hi);transform:translateX(4px)}.obj-num{font-family:var(--fM);font-size:.75rem;font-weight:600;color:#fff;background:var(--ac);width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.obj-text{font-size:.95rem;color:var(--tx1)}
.acc-item{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--r);margin-bottom:12px;overflow:hidden;box-shadow:var(--shd)}.acc-hd{width:100%;display:flex;align-items:center;justify-content:space-between;padding:20px 24px;background:none;border:none;cursor:pointer;font-family:var(--fH);font-size:1.05rem;font-weight:700;color:var(--tx0);text-align:left;transition:all var(--t);gap:12px}.acc-hd:hover,.acc-hd:focus-visible{background:var(--acG)}.acc-hd .chv{font-size:1.2rem;transition:transform var(--t);flex-shrink:0;color:var(--ac)}.acc-item.open .chv{transform:rotate(180deg)}.acc-bd{max-height:0;overflow:hidden;transition:max-height .4s ease}.acc-ct{padding:0 24px 24px;color:var(--tx1);line-height:1.8}.acc-ct p{margin-bottom:12px}.acc-ct strong{color:var(--tx0)}.kt{display:inline;background:var(--acG);color:var(--ac);padding:2px 8px;border-radius:4px;font-weight:600;font-size:.9rem}.info-box{background:var(--bg2);border-left:4px solid var(--ac);padding:16px 20px;border-radius:0 var(--rs) var(--rs) 0;margin:16px 0;font-size:.95rem}.info-box.warn{border-left-color:var(--hi)}
.fc-stats{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;font-family:var(--fM);font-size:.85rem;color:var(--tx2)}
.fc-viewport{perspective:1200px;width:100%;max-width:620px;height:300px;margin:0 auto 14px;cursor:pointer}
.fc-prism{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .7s cubic-bezier(.4,0,.2,1)}
.fc-face{position:absolute;inset:0;backface-visibility:hidden;border-radius:var(--r);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 28px;text-align:center;overflow-y:auto}
.fc-face--term{background:linear-gradient(135deg,var(--ac),var(--ac2));color:#fff;transform:rotateX(0deg) translateZ(87px)}
.fc-face--def{background:var(--bg1);border:2px solid var(--ac);color:var(--tx0);transform:rotateX(-120deg) translateZ(87px)}
.fc-face--example{background:linear-gradient(135deg,#6B4C9A,#9B6DFF);color:#fff;transform:rotateX(-240deg) translateZ(87px)}
[data-theme="dark"] .fc-face--example{background:linear-gradient(135deg,#4A3070,#7B4FCC)}
.fc-lbl{font-family:var(--fM);font-size:.65rem;letter-spacing:2.5px;text-transform:uppercase;margin-bottom:14px;display:flex;align-items:center;gap:8px}
.fc-face--term .fc-lbl{opacity:.75}.fc-face--def .fc-lbl{color:var(--ac)}.fc-face--example .fc-lbl{opacity:.8}
.fc-lbl-icon{width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.7rem;flex-shrink:0}
.fc-face--term .fc-lbl-icon{background:rgba(255,255,255,.2)}.fc-face--def .fc-lbl-icon{background:var(--acG)}.fc-face--example .fc-lbl-icon{background:rgba(255,255,255,.2)}
.fc-main{font-family:var(--fH);font-size:1.4rem;font-weight:700;line-height:1.4}
.fc-face--def .fc-main{font-family:var(--fB);font-size:1.02rem;font-weight:400;line-height:1.65;color:var(--tx1)}
.fc-face--example .fc-main{font-family:var(--fB);font-size:1rem;font-weight:400;line-height:1.65}
.fc-ex-pre{font-weight:700;font-style:normal;display:block;margin-bottom:6px;font-size:.82rem;letter-spacing:.5px;opacity:.85}
.fc-hint{margin-top:18px;font-size:.78rem;opacity:.55}
.fc-dots{display:flex;justify-content:center;gap:24px;margin-bottom:20px}
.fc-dot-grp{display:flex;flex-direction:column;align-items:center;gap:5px;cursor:pointer}
.fc-dot{width:12px;height:12px;border-radius:50%;background:var(--bdr);border:2px solid transparent;cursor:pointer;transition:all var(--t);padding:0}
.fc-dot:hover{transform:scale(1.3)}
.fc-dot.a-term{background:var(--ac);border-color:var(--ac);box-shadow:0 0 10px var(--acG)}
.fc-dot.a-def{background:var(--ac2);border-color:var(--ac2);box-shadow:0 0 10px var(--acG)}
.fc-dot.a-ex{background:#9B6DFF;border-color:#9B6DFF;box-shadow:0 0 10px rgba(155,109,255,.3)}
.fc-dot-lbl{font-size:.68rem;font-family:var(--fM);color:var(--tx2);letter-spacing:.5px;transition:color var(--t)}
.fc-dot-grp.active .fc-dot-lbl{color:var(--tx0);font-weight:600}
.fc-ctrls{display:flex;justify-content:center;gap:10px;flex-wrap:wrap}.fc-btn{padding:10px 22px;border:2px solid var(--bdr);border-radius:50px;background:var(--bg1);color:var(--tx0);font-family:var(--fB);font-weight:600;font-size:.88rem;cursor:pointer;transition:all var(--t)}.fc-btn:hover,.fc-btn:focus-visible{background:var(--ac);border-color:var(--ac);color:#fff}.fc-btn.pri{background:var(--ac);border-color:var(--ac);color:#fff}
.fc-btn.flip{background:var(--bg2);border-color:var(--bdr);min-width:140px}
.quiz-progress{font-family:var(--fM);font-size:.85rem;color:var(--tx2);margin-bottom:20px}.quiz-q{font-family:var(--fH);font-size:1.15rem;font-weight:700;margin-bottom:20px;color:var(--tx0)}.quiz-opts{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}.quiz-opt{display:flex;align-items:center;gap:14px;padding:16px 20px;background:var(--bg1);border:2px solid var(--bdr);border-radius:var(--rs);cursor:pointer;transition:all var(--t);font-size:.95rem;color:var(--tx1)}.quiz-opt:hover,.quiz-opt:focus-visible{border-color:var(--ac);background:var(--acG)}.quiz-opt.selected{border-color:var(--ac);background:var(--acG)}.quiz-opt.correct{border-color:var(--ok);background:rgba(45,106,79,.1);color:var(--ok)}.quiz-opt.incorrect{border-color:var(--hi);background:rgba(196,69,54,.1);color:var(--hi)}.quiz-opt .ltr{width:30px;height:30px;border-radius:50%;background:var(--bg2);display:flex;align-items:center;justify-content:center;font-family:var(--fM);font-weight:600;font-size:.8rem;flex-shrink:0}.quiz-opt.selected .ltr{background:var(--ac);color:#fff}.quiz-opt.correct .ltr{background:var(--ok);color:#fff}.quiz-opt.incorrect .ltr{background:var(--hi);color:#fff}.quiz-fb{padding:16px 20px;border-radius:var(--rs);margin-bottom:20px;font-weight:600;display:none}.quiz-fb.ok{display:block;background:rgba(45,106,79,.1);color:var(--ok);border:1px solid var(--ok)}.quiz-fb.no{display:block;background:rgba(196,69,54,.1);color:var(--hi);border:1px solid var(--hi)}
.btn{padding:12px 28px;border:none;border-radius:50px;font-family:var(--fB);font-weight:600;font-size:.95rem;cursor:pointer;transition:all var(--t)}.btn.pri{background:var(--ac);color:#fff}.btn.pri:hover{background:var(--ac2)}.btn.sec{background:var(--bg2);color:var(--tx0);border:1px solid var(--bdr)}.btn-row{display:flex;gap:12px;flex-wrap:wrap}
.score-circle{width:140px;height:140px;border-radius:50%;background:var(--acG);border:4px solid var(--ac);display:flex;flex-direction:column;align-items:center;justify-content:center;margin:0 auto 24px}.score-num{font-family:var(--fH);font-size:2.5rem;font-weight:900;color:var(--ac);line-height:1}.score-lbl{font-size:.8rem;color:var(--tx2);font-family:var(--fM)}
.match-container{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin:20px 0}.match-col-title{font-family:var(--fM);font-size:.75rem;letter-spacing:2px;text-transform:uppercase;color:var(--ac);margin-bottom:12px}.match-item{padding:14px 18px;background:var(--bg1);border:2px solid var(--bdr);border-radius:var(--rs);margin-bottom:8px;cursor:pointer;transition:all var(--t);font-size:.9rem;user-select:none}.match-item:hover{border-color:var(--ac)}.match-item.sel{border-color:var(--ac);background:var(--acG);box-shadow:0 0 0 3px var(--acG)}.match-item.matched{border-color:var(--ok);background:rgba(45,106,79,.08);opacity:.7;cursor:default}.match-item.wrong{border-color:var(--hi);animation:shake .4s ease}@keyframes shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-6px)}40%,80%{transform:translateX(6px)}}.match-score{text-align:center;font-family:var(--fM);font-size:.9rem;color:var(--tx2);margin-top:16px}
.sort-list{list-style:none;max-width:600px;margin:16px auto}.sort-item{padding:16px 20px;background:var(--bg1);border:2px solid var(--bdr);border-radius:var(--rs);margin-bottom:8px;cursor:grab;display:flex;align-items:center;gap:14px;transition:all var(--t);user-select:none;font-size:.95rem}.sort-item:active{cursor:grabbing}.sort-item.dragging{opacity:.4;border-color:var(--ac)}.sort-item.over{border-color:var(--ac2);background:var(--acG)}.sort-item .grip{color:var(--tx2);font-size:1.2rem;flex-shrink:0}.sort-item .s-num{font-family:var(--fM);font-size:.75rem;font-weight:600;color:#fff;background:var(--ac);width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.sort-item.correct-pos{border-color:var(--ok);background:rgba(45,106,79,.06)}.sort-item.wrong-pos{border-color:var(--hi);background:rgba(196,69,54,.06)}
.tf-card{background:var(--bg1);border:2px solid var(--bdr);border-radius:var(--r);padding:28px;margin-bottom:16px;text-align:center;transition:all var(--t)}.tf-card.answered-true{border-color:var(--ok);background:rgba(45,106,79,.06)}.tf-card.answered-false{border-color:var(--hi);background:rgba(196,69,54,.06)}.tf-statement{font-family:var(--fH);font-size:1.05rem;font-weight:700;margin-bottom:20px;color:var(--tx0)}.tf-btns{display:flex;gap:12px;justify-content:center}.tf-btn{padding:12px 36px;border:2px solid var(--bdr);border-radius:50px;background:var(--bg1);font-family:var(--fB);font-weight:700;font-size:1rem;cursor:pointer;transition:all var(--t);color:var(--tx0)}.tf-btn:hover{border-color:var(--ac);background:var(--acG)}.tf-btn:disabled{cursor:default;opacity:.6}.tf-result{margin-top:14px;font-weight:600;font-size:.95rem}.tf-result.ok{color:var(--ok)}.tf-result.no{color:var(--hi)}
.sg-box{background:linear-gradient(135deg,var(--bg1),var(--bg2));border:2px solid var(--ac);border-radius:var(--r);padding:32px;margin:20px 0}.sg-lbl{font-family:var(--fM);font-size:.75rem;letter-spacing:2px;text-transform:uppercase;color:var(--ac);margin-bottom:12px}.sg-text{font-size:1.05rem;line-height:1.7;color:var(--tx1);margin-bottom:20px}.sg-choices{display:flex;flex-direction:column;gap:10px}.sg-choice{padding:16px 20px;border:2px solid var(--bdr);border-radius:var(--rs);cursor:pointer;transition:all var(--t);font-size:.95rem;text-align:left;background:var(--bg1);color:var(--tx1)}.sg-choice:hover{border-color:var(--ac);background:var(--acG)}.sg-choice.best{border-color:var(--ok);background:rgba(45,106,79,.08)}.sg-choice.okay{border-color:var(--warn);background:rgba(233,196,106,.1)}.sg-choice.bad{border-color:var(--hi);background:rgba(196,69,54,.08)}.sg-feedback{margin-top:16px;padding:16px 20px;border-radius:var(--rs);font-weight:600;font-size:.95rem}.sg-progress-dots{display:flex;gap:8px;justify-content:center;margin-bottom:20px}.sg-dot{width:12px;height:12px;border-radius:50%;background:var(--bdr);transition:all var(--t)}.sg-dot.active{background:var(--ac);transform:scale(1.3)}.sg-dot.done{background:var(--ok)}
.tab-row{display:flex;gap:4px;margin-bottom:20px;border-bottom:2px solid var(--bdr);overflow-x:auto;scrollbar-width:none}.tab-row::-webkit-scrollbar{display:none}.tab-btn{background:none;border:none;padding:10px 18px;font-family:var(--fB);font-size:.9rem;font-weight:600;color:var(--tx2);cursor:pointer;border-bottom:3px solid transparent;transition:all var(--t);white-space:nowrap}.tab-btn:hover,.tab-btn:focus-visible{color:var(--ac)}.tab-btn.active{color:var(--ac);border-bottom-color:var(--ac)}.tab-panel{display:none}.tab-panel.active{display:block;animation:fadeIn .3s ease}
.glo-search{width:100%;padding:14px 20px;border:2px solid var(--bdr);border-radius:50px;background:var(--bg1);font-family:var(--fB);font-size:1rem;color:var(--tx0);margin-bottom:20px;transition:border-color var(--t)}.glo-search:focus{outline:none;border-color:var(--ac);box-shadow:0 0 0 3px var(--acG)}.glo-item{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--rs);padding:18px 22px;margin-bottom:10px;transition:all var(--t)}.glo-item:hover{border-color:var(--ac)}.glo-term{font-family:var(--fH);font-weight:700;font-size:1.05rem;color:var(--ac);margin-bottom:4px}.glo-def{color:var(--tx1);font-size:.95rem}
.vid-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px}.vid-card{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--r);overflow:hidden;box-shadow:var(--shd);transition:all var(--t)}.vid-card:hover{box-shadow:var(--shd2);transform:translateY(-4px)}.vid-embed{width:100%;aspect-ratio:16/9;border:none}.vid-info{padding:16px 20px}.vid-title{font-family:var(--fH);font-weight:700;font-size:1rem;color:var(--tx0);margin-bottom:6px}.vid-desc{font-size:.85rem;color:var(--tx2);line-height:1.5}
@media(max-width:640px){.hero{padding:40px 16px 36px}.hero h1{font-size:1.5rem}.container{padding:20px 16px 60px}.obj-grid,.vid-grid{grid-template-columns:1fr}.nav-btn{padding:12px 12px;font-size:.78rem}.fc-viewport{height:240px}.match-container{grid-template-columns:1fr}}
*:focus-visible{outline:2px solid var(--ac);outline-offset:2px}
</style>
</head>
<body>
<a href="#main-content" class="skip-link">Skip to main content</a>
<header class="hero" role="banner"><div class="hero-badge">Chapter 5</div><h1>Working with Windows &amp; CLI Systems</h1><p>Explore how data is stored on Microsoft file systems, understand NTFS disk structures, the Windows Registry, encryption, boot processes, and virtual machines for forensic analysis.</p></header>
<div class="progress-container" role="navigation" aria-label="Progress"><div class="progress-bar-wrap" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Lesson progress"><div class="progress-bar" id="progressBar"></div></div><span class="progress-text" id="progressText">0%</span><button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">&#x1F319;</button></div>
<nav class="nav-bar" aria-label="Lesson sections"><button class="nav-btn active" data-section="objectives">Objectives</button><button class="nav-btn" data-section="content">Lesson</button><button class="nav-btn" data-section="activities">Activities</button><button class="nav-btn" data-section="flashcards">Flashcards</button><button class="nav-btn" data-section="quiz">Quiz</button><button class="nav-btn" data-section="glossary">Glossary</button><button class="nav-btn" data-section="videos">Videos</button></nav>
<main id="main-content" class="container">

<div class="section active" id="objectives" role="region" aria-label="Learning Objectives"><h2><span class="icon">&#x1F3AF;</span> Learning Objectives</h2><p class="section-sub">By the end of this chapter, you should be able to:</p><div class="obj-grid"><div class="obj-card"><span class="obj-num">1</span><span class="obj-text">Explain the purpose and structure of file systems</span></div><div class="obj-card"><span class="obj-num">2</span><span class="obj-text">Describe Microsoft file structures including FAT and NTFS</span></div><div class="obj-card"><span class="obj-num">3</span><span class="obj-text">Explain the structure of NTFS disks and the Master File Table</span></div><div class="obj-card"><span class="obj-num">4</span><span class="obj-text">List options for decrypting drives encrypted with whole disk encryption</span></div><div class="obj-card"><span class="obj-num">5</span><span class="obj-text">Explain how the Windows Registry works and its forensic value</span></div><div class="obj-card"><span class="obj-num">6</span><span class="obj-text">Describe Microsoft startup tasks and boot processes</span></div><div class="obj-card"><span class="obj-num">7</span><span class="obj-text">Explain the purpose and forensic applications of virtual machines</span></div></div></div>

<div class="section" id="content" role="region" aria-label="Lesson Content"><h2><span class="icon">&#x1F4D6;</span> Lesson Content</h2><p class="section-sub">Click each section to expand and explore the material.</p>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>1. Understanding File Systems &amp; Boot Sequence</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>A <span class="kt">file system</span> gives an OS a road map to data on a disk. The type of file system determines how data is stored, and you must be familiar with a suspect&rsquo;s OS and file system before accessing their computer.</p><p>The <span class="kt">CMOS</span> stores system configuration and date/time information when power is off. The <span class="kt">BIOS</span> (or <span class="kt">EFI</span>/<span class="kt">UEFI</span>) contains programs for hardware-level input/output.</p><div class="info-box warn"><strong>Forensic Critical:</strong> When a suspect&rsquo;s computer starts, you must ensure it boots to a forensically configured CD, DVD, or USB drive &mdash; booting to the hard disk <strong>overwrites and changes evidentiary data</strong>.</div><p>The <span class="kt">bootstrap process</span> is contained in ROM and tells the computer how to proceed when booting. Modify the CMOS settings to control boot order.</p></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>2. Disk Drives &amp; Microsoft File Structures</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>Disk drive <span class="kt">geometry</span> refers to the internal organization of platters, tracks, and sectors. Properties include <strong>heads</strong> (read/write devices), <strong>tracks</strong> (concentric circles), <strong>cylinders</strong> (tracks aligned across platters), and <strong>sectors</strong> (typically 512 bytes each).</p><p>Solid-state drives use <span class="kt">wear-leveling</span> to distribute writes evenly. From a forensics standpoint, make an immediate copy of a drive because wear-leveling can destroy deleted data.</p><h3>Clusters &amp; Addressing</h3><p>Microsoft OSs group sectors into <span class="kt">clusters</span> (storage allocation units). <span class="kt">Logical addresses</span> use sequential cluster numbers starting at 2, while <span class="kt">physical addresses</span> point to actual sectors at the hardware level.</p><p>The <span class="kt">Master Boot Record (MBR)</span> contains information about disk partitions, their locations, and sizes. It includes a partition table at offset 446 in sector 0 of the disk.</p></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>3. FAT File Systems</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p><span class="kt">File Allocation Table (FAT)</span> is the original file structure database designed for floppy disks. A FAT database is written to the disk&rsquo;s outermost track and contains filenames, directory names, date/time stamps, starting cluster numbers, and file attributes.</p><h3>FAT Evolution</h3><p><strong>FAT12</strong> &rarr; <strong>FAT16</strong> &rarr; <strong>FAT32</strong> &rarr; <strong>exFAT</strong>. Cluster sizes vary by disk size and file system version. FAT16 supported up to 2 GB, while FAT32 extended support to much larger drives.</p><h3>Drive Slack</h3><p><span class="kt">Drive slack</span> is the unused space in a cluster between the end of a file and the end of the cluster. It consists of <span class="kt">RAM slack</span> (unused space from EOF to end of the last sector) and <span class="kt">file slack</span> (unused sectors in the cluster). This slack space can contain deleted files, passwords, logon IDs, and file fragments.</p><h3>Deleting FAT Files</h3><p>When a file is deleted, the directory entry is marked with the <span class="kt">HEX E5</span> character replacing the first letter of the filename, and the FAT chain is set to 0. <strong>The data remains on the disk</strong> &mdash; only the pointers are removed, making recovery possible.</p></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>4. NTFS Disk Structure &amp; the MFT</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p><span class="kt">NTFS (NT File System)</span> was introduced with Windows NT and remains the primary file system for Windows 10. Improvements over FAT include more file information, better control over files/folders, smaller clusters (less slack space), Unicode support, and <strong>journaling</strong> (records transactions before executing them).</p><h3>Partition Boot Sector &amp; MFT</h3><p>The first data set on an NTFS disk is the <span class="kt">Partition Boot Sector</span>, starting at sector 0 and expanding up to 16 sectors. Immediately after is the <span class="kt">Master File Table (MFT)</span> &mdash; a database that stores and links to all files on the disk.</p><h3>MFT Records &amp; Attributes</h3><p>All files and folders are stored in separate MFT records of <strong>1024 bytes each</strong>. Record fields are called <span class="kt">attribute IDs</span>. Data is stored as <strong>resident</strong> (within the MFT record for files &le; 512 bytes) or <strong>nonresident</strong> (stored outside the MFT with cluster addresses called <span class="kt">data runs</span>).</p><p><span class="kt">Logical Cluster Numbers (LCNs)</span> reference physical disk locations. <span class="kt">Virtual Cluster Numbers (VCNs)</span> are offsets from previous LCN data runs, used when files are fragmented across the partition.</p><div class="info-box"><strong>NTFS System Files:</strong> The first 15 MFT records are reserved: $MFT (record 0), $MFTMirr (1), $LogFile (2), $Volume (3), $AttrDef (4), $ root directory (5), $Bitmap (6), $Boot (7), $BadClus (8), $Secure (9), $Upcase (10), $Extend (11), and records 12&ndash;15 reserved for future use.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>5. NTFS Features: ADS, Compression &amp; Deletion</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><h3>Alternate Data Streams (ADS)</h3><p><span class="kt">Alternate data streams</span> allow data to be appended to existing files. They can obscure valuable evidentiary data, intentionally or by coincidence. In NTFS, an ADS becomes an additional file attribute. You can only detect a data stream by examining the file&rsquo;s MFT record entry.</p><h3>NTFS Compression</h3><p>NTFS provides compression for files, folders, or entire volumes. Most forensics tools can uncompress and analyze compressed Windows data.</p><h3>Deleting NTFS Files</h3><p>When a file is deleted in Windows, the OS renames it and moves it to the <span class="kt">Recycle Bin</span>. Using the <code>del</code> command at the command prompt eliminates the file from the MFT listing similar to how FAT handles deletion. In both cases, the actual data remains on disk until overwritten.</p></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>6. Encryption: EFS, BitLocker &amp; Whole Disk</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><h3>Encrypting File System (EFS)</h3><p><span class="kt">EFS</span> was introduced with Windows 2000 and uses <span class="kt">public key</span> and <span class="kt">private key</span> methods to encrypt files, folders, or disk volumes. A <span class="kt">recovery certificate</span> is generated and sent to the local Windows administrator account. Administrators can recover keys using the <code>cipher</code> and <code>copy</code> commands.</p><h3>BitLocker</h3><p><span class="kt">BitLocker</span> provides whole-volume encryption. Requirements include: a <span class="kt">TPM</span> (Trusted Platform Module) microchip v1.2+, a <span class="kt">TCG</span>-compliant BIOS, two NTFS partitions, and the BIOS configured to boot from the hard drive first.</p><h3>Whole Disk Encryption (WDE)</h3><p>WDE tools encrypt each sector separately, including the boot sector. Features include preboot authentication, full/partial disk encryption with secure hibernation, advanced algorithms, and key management. To examine an encrypted drive, you must <strong>decrypt it first</strong> using a vendor-specific program or a <span class="kt">one-time passphrase</span>.</p></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>7. Windows Registry</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>The <span class="kt">Windows Registry</span> is a database storing hardware/software configuration, network connections, user preferences, and setup information. For investigators, the Registry contains <strong>valuable evidence</strong>.</p><h3>Registry Organization</h3><p>Key terminology: <strong>HKEY</strong> (handle to a key &mdash; top-level category), <strong>Key</strong> (container within an HKEY), <strong>Subkey</strong> (nested key), <strong>Branch</strong> (complete path), <strong>Value</strong> (data entry), <strong>Hives</strong> (group of keys/subkeys/values stored as a file).</p><h3>Registry HKEYs</h3><p><span class="kt">HKEY_LOCAL_MACHINE</span> &mdash; hardware and software configuration. <span class="kt">HKEY_CURRENT_USER</span> &mdash; current user settings. <span class="kt">HKEY_CLASSES_ROOT</span> &mdash; file associations and COM objects. <span class="kt">HKEY_USERS</span> &mdash; all loaded user profiles. <span class="kt">HKEY_CURRENT_CONFIG</span> &mdash; current hardware profile.</p><div class="info-box"><strong>Forensic Tip:</strong> Registry files are located in <code>C:\Windows\System32\Config</code>. Transaction logs (.LOG files) record changes to the Registry. You can use Regedit, Regedt32, or forensic tools to examine them.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>8. Microsoft Startup Tasks &amp; Boot Process</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>Understanding startup tasks helps determine when a suspect&rsquo;s computer was last accessed &mdash; critical when a computer might have been used after an incident.</p><h3>NTFS Boot Sequence</h3><p>All NTFS computers perform these steps: <strong>1)</strong> Power-on Self Test (POST) &rarr; <strong>2)</strong> Initial startup &rarr; <strong>3)</strong> Boot loader &rarr; <strong>4)</strong> Hardware detection &amp; configuration &rarr; <strong>5)</strong> Kernel loading &rarr; <strong>6)</strong> User logon.</p><h3>Vista and Later</h3><p>Windows Vista replaced the older NTLDR with three boot utilities: <span class="kt">Bootmgr.exe</span>, <span class="kt">Winload.exe</span>, and <span class="kt">Winresume.exe</span>. The <span class="kt">Boot Configuration Data (BCD)</span> store controls the boot process. Press F8 or F12 for Advanced Boot Options.</p><h3>Windows XP Startup Files</h3><p><span class="kt">NTLDR</span> (NT Loader), <span class="kt">Boot.ini</span>, <span class="kt">BootSect.dos</span>, <span class="kt">NTDetect.com</span>, <span class="kt">NTBootdd.sys</span>, <span class="kt">Ntoskrnl.exe</span>, <span class="kt">Hal.dll</span>, and <span class="kt">Pagefile.sys</span>.</p><div class="info-box warn"><strong>Evidence Risk:</strong> Starting a Windows XP NTFS workstation changes the last access date/time stamps on system files to the current date, <strong>destroying evidence</strong> of when the workstation was last used.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>9. Resilient File System &amp; Virtual Machines</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><h3>Resilient File System (ReFS)</h3><p><span class="kt">ReFS</span> was introduced in Windows Server 2012 for large data storage needs (e.g., cloud storage). It uses a <span class="kt">B+-tree</span> structure for fast access and features maximized data availability, improved integrity, and designed scalability.</p><h3>Virtual Machines</h3><p><span class="kt">Virtual machines</span> emulate a computer&rsquo;s hardware environment, letting you run another OS on a host computer. The <strong>guest OS</strong> is limited by the <strong>host computer&rsquo;s</strong> capabilities.</p><h3>Forensic Applications</h3><p>Virtual machines allow investigators to: restore a suspect&rsquo;s drive and boot it in a controlled environment, run nonstandard software the suspect might have loaded, and test forensic procedures safely.</p><div class="info-box"><strong>Popular VM Tools:</strong> VMware Workstation/Player, Oracle VirtualBox, Microsoft Virtual PC, and Hyper-V. A <span class="kt">virtual hard disk (VHD)</span> file represents a system&rsquo;s hard drive that can be booted in virtualization software.</div></div></div></div>
</div>

<div class="section" id="activities" role="region" aria-label="Interactive Activities"><h2><span class="icon">&#x1F9E9;</span> Interactive Activities</h2><p class="section-sub">Practice what you&rsquo;ve learned with hands-on exercises.</p>
<div class="tab-row" role="tablist"><button class="tab-btn active" data-tab="matching" role="tab">Term Matching</button><button class="tab-btn" data-tab="sorting" role="tab">Step Sorting</button><button class="tab-btn" data-tab="truefalse" role="tab">True / False</button><button class="tab-btn" data-tab="scenario" role="tab">Scenario</button></div>
<div class="tab-panel active" id="tab-matching"><h3>Match the Term to Its Definition</h3><p style="color:var(--tx2);margin-bottom:16px">Click a term on the left, then click its matching definition on the right.</p><div class="match-container"><div><div class="match-col-title">Terms</div><div id="matchTerms"></div></div><div><div class="match-col-title">Definitions</div><div id="matchDefs"></div></div></div><div class="match-score" id="matchScore">Matched: 0 / 6</div><div style="text-align:center;margin-top:12px"><button class="btn sec" id="matchReset">Reset</button></div></div>
<div class="tab-panel" id="tab-sorting"><h3>Sort the Windows NT Boot Sequence</h3><p style="color:var(--tx2);margin-bottom:16px">Drag and drop these steps into the correct order for the NTFS boot process.</p><ul class="sort-list" id="sortList" role="list"></ul><div style="text-align:center;margin-top:16px"><button class="btn pri" id="sortCheck">Check Order</button><button class="btn sec" id="sortReset" style="margin-left:8px">Reset</button></div><div id="sortFeedback" style="text-align:center;margin-top:16px;font-weight:600"></div></div>
<div class="tab-panel" id="tab-truefalse"><h3>True or False &mdash; Rapid Fire</h3><p style="color:var(--tx2);margin-bottom:16px">Test your knowledge quickly!</p><div id="tfContainer"></div><div id="tfScore" style="text-align:center;margin-top:20px;font-family:var(--fM);color:var(--tx2)"></div></div>
<div class="tab-panel" id="tab-scenario"><h3>Windows Forensics Scenario Walkthrough</h3><p style="color:var(--tx2);margin-bottom:16px">You are investigating a Windows workstation. Make the right decisions!</p><div class="sg-box" id="sgBox"><div class="sg-progress-dots" id="sgDots"></div><div class="sg-lbl" id="sgLabel">Scenario</div><div class="sg-text" id="sgText"></div><div class="sg-choices" id="sgChoices"></div><div class="sg-feedback" id="sgFeedback" style="display:none"></div><div style="text-align:center;margin-top:16px"><button class="btn pri" id="sgNext" style="display:none">Continue &rarr;</button></div></div><div id="sgResult" style="display:none;text-align:center;padding:20px"></div></div>
</div>

<div class="section" id="flashcards" role="region" aria-label="Flashcards"><h2><span class="icon">&#x1F0CF;</span> 3D Flashcards</h2><p class="section-sub">Click the card to rotate through three faces: Term &rarr; Definition &rarr; Example. Use arrow keys to navigate between cards.</p><div class="fc-stats"><span id="fcCounter">Card 1 of 15</span><span id="fcScore"></span></div>
<div class="fc-dots" id="fcDots"><div class="fc-dot-grp active" data-face="0"><button class="fc-dot a-term" aria-label="Show term" data-face="0"></button><span class="fc-dot-lbl">Term</span></div><div class="fc-dot-grp" data-face="1"><button class="fc-dot" aria-label="Show definition" data-face="1"></button><span class="fc-dot-lbl">Definition</span></div><div class="fc-dot-grp" data-face="2"><button class="fc-dot" aria-label="Show example" data-face="2"></button><span class="fc-dot-lbl">Example</span></div></div>
<div class="fc-viewport" id="fcViewport" tabindex="0" role="button" aria-label="3D Flashcard &mdash; click or press Enter to rotate">
<div class="fc-prism" id="fcPrism">
<div class="fc-face fc-face--term"><div class="fc-lbl"><span class="fc-lbl-icon">&#x1F4CC;</span> Term</div><div class="fc-main" id="fcTerm"></div><div class="fc-hint">Click to see definition &rarr;</div></div>
<div class="fc-face fc-face--def"><div class="fc-lbl"><span class="fc-lbl-icon">&#x1F4D6;</span> Definition</div><div class="fc-main" id="fcDef"></div></div>
<div class="fc-face fc-face--example"><div class="fc-lbl"><span class="fc-lbl-icon">&#x1F4A1;</span> Example</div><div class="fc-main" id="fcEx"></div></div>
</div></div>
<div class="fc-ctrls"><button class="fc-btn" id="fcPrev">&larr; Previous</button><button class="fc-btn flip" id="fcFlip">Rotate Card &#x21BB;</button><button class="fc-btn pri" id="fcNext">Next &rarr;</button></div></div>

<div class="section" id="quiz" role="region" aria-label="Knowledge Quiz"><h2><span class="icon">&#x2705;</span> Knowledge Check</h2><p class="section-sub">Test your understanding with review questions.</p><div class="card"><div id="quizArea"><div class="quiz-progress" id="quizProgress"></div><div class="quiz-q" id="quizQ"></div><div class="quiz-opts" id="quizOpts" role="radiogroup"></div><div class="quiz-fb" id="quizFb"></div><div class="btn-row"><button class="btn pri" id="quizSubmit">Check Answer</button><button class="btn sec" id="quizNext" style="display:none">Next Question &rarr;</button></div></div><div id="quizResults" style="display:none;text-align:center;padding:40px 20px"><div class="score-circle"><span class="score-num" id="finalScore"></span><span class="score-lbl">correct</span></div><h3 id="scoreMsg"></h3><p style="color:var(--tx2);margin:12px 0 24px">Review the lesson and try again to improve.</p><button class="btn pri" id="quizRestart">Restart Quiz</button></div></div></div>

<div class="section" id="glossary" role="region" aria-label="Glossary"><h2><span class="icon">&#x1F4DA;</span> Key Terms Glossary</h2><p class="section-sub">Search or browse key terms from this chapter.</p><input type="text" class="glo-search" id="gloSearch" placeholder="Search terms..." aria-label="Search glossary"><div id="gloList"></div></div>

<div class="section" id="videos" role="region" aria-label="Related Videos"><h2><span class="icon">&#x1F3AC;</span> Related Videos</h2><p class="section-sub">Curated videos to reinforce your learning.</p><div class="vid-grid">
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/xW5UwDztkX4" title="File Systems: NTFS, FAT32, exFAT Explained" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">File Systems Explained &mdash; NTFS, FAT32, exFAT</div><div class="vid-desc">Comprehensive overview of the major Windows file systems, their differences, and when each is used.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/gOOYukcLkM4" title="Windows Registry for Digital Forensics" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">Windows Registry for Digital Forensics</div><div class="vid-desc">How forensic investigators analyze the Windows Registry to uncover evidence of user activity and system configuration.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/hqtvwv9c6Sk" title="Windows Boot Process Explained" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">Windows Boot Process Explained</div><div class="vid-desc">Step-by-step walkthrough of the Windows boot sequence from POST through kernel loading and user logon.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/3ifQ5mYQa9E" title="BitLocker Drive Encryption Explained" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">BitLocker Drive Encryption Explained</div><div class="vid-desc">Understanding how BitLocker whole-disk encryption works, its requirements, and implications for forensic examiners.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/KePKZTk8_7Y" title="Master File Table and NTFS Forensics" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">NTFS &amp; the Master File Table</div><div class="vid-desc">Deep dive into NTFS internals including the MFT structure, file attributes, data runs, and how forensic examiners analyze them.</div></div></div>
</div></div>

</main>
<script>
const flashcards=[
{term:"Master File Table (MFT)",def:"The NTFS database that stores and links to all files on the disk. Contains information about access rights, date/time stamps, system attributes, and file locations. The first 15 records are reserved for system files.",ex:"A forensic examiner opens a suspect's NTFS drive image and examines the MFT to discover 47 deleted files. The MFT records still contain the original filenames, timestamps, and cluster locations \u2014 allowing full file recovery even though the user emptied the Recycle Bin."},
{term:"Drive Slack",def:"Unused space in a cluster between the end of an active file and the end of the cluster. Composed of RAM slack and file slack. Can contain deleted files, passwords, logon IDs, and email fragments.",ex:"An investigator examines a 4 KB cluster where a 2.5 KB file is stored. The remaining 1.5 KB of drive slack contains fragments of a previously deleted spreadsheet showing unauthorized wire transfers \u2014 evidence the suspect thought was permanently destroyed."},
{term:"FAT (File Allocation Table)",def:"The original Microsoft file structure database, written to the outermost track of a disk. Contains filenames, directory names, date/time stamps, starting cluster numbers, and file attributes. Variants: FAT12, FAT16, FAT32, exFAT.",ex:"While analyzing a USB thumb drive formatted with FAT32, the examiner finds deleted files marked with the HEX E5 character. Since only the first letter was changed, the investigator reconstructs the original filenames and recovers the complete files."},
{term:"Alternate Data Streams (ADS)",def:"Ways data can be appended to existing NTFS files, becoming an additional file attribute. Can obscure evidentiary data intentionally or by coincidence. Detectable only by examining the file's MFT record entry.",ex:"A suspect hides a stolen database inside an ADS attached to an innocent-looking vacation photo. The photo appears normal at 2 MB, but the MFT record reveals a hidden 50 MB data stream containing the company's customer records."},
{term:"Windows Registry",def:"A database storing hardware and software configuration information, network connections, user preferences, and setup information. Organized into HKEYs, keys, subkeys, branches, values, and hives. Files stored in C:\\Windows\\System32\\Config.",ex:"An investigator examines HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs and finds a list of recently accessed files, including documents the suspect claimed never to have opened."},
{term:"BitLocker",def:"Microsoft's whole-volume encryption feature requiring TPM v1.2+, a TCG-compliant BIOS, two NTFS partitions, and hard drive as first boot device. Available in Professional and Enterprise editions of Windows.",ex:"Investigators seize a laptop with BitLocker enabled. Without the recovery key, the entire 500 GB drive is unreadable. They obtain the recovery key from the company's Active Directory and successfully decrypt the drive to access evidence."},
{term:"Encrypting File System (EFS)",def:"A public/private key encryption method introduced in Windows 2000 for NTFS disks. A recovery certificate is generated for the Windows administrator. Keys can be recovered using the cipher and copy commands.",ex:"An employee encrypts sensitive R&D files with EFS before leaving the company. The IT administrator uses the EFS Recovery Key Agent and the cipher command to decrypt the files and recover the proprietary research data."},
{term:"Boot Configuration Data (BCD)",def:"In Windows Vista and later, a Registry file that controls the boot process, replacing the older Boot.ini file. Contains the boot loader that initiates the system's bootstrap process. Editable with the BCD Editor.",ex:"A forensic analyst examines the BCD store on a suspect's Windows 10 machine and discovers a dual-boot configuration with a hidden Linux partition \u2014 the suspect was using it to run hacking tools undetected."},
{term:"Logical Cluster Numbers (LCNs)",def:"Numbers the MFT uses to refer to specific physical locations on a disk partition. LCNs become addresses that allow the MFT to read and write data to the disk's nonresident attribute area.",ex:"When tracing a fragmented 10 GB video file across the disk, the examiner follows the MFT's LCN references: the first segment starts at LCN 45000, jumps to LCN 82000 for the middle portion, and ends at LCN 120000."},
{term:"Partition Boot Sector",def:"The first data set on an NTFS disk. Starts at sector 0 of the drive and can expand up to 16 sectors. Contains essential information for the operating system to access the NTFS volume.",ex:"During analysis, an examiner reads the Partition Boot Sector and identifies the NTFS volume signature, bytes per sector (512), sectors per cluster (8), and the starting location of the MFT \u2014 critical for manual data recovery."},
{term:"Data Runs",def:"Cluster addresses stored in MFT records that point to where nonresident file data is stored on the drive's partition. Each MFT record header identifies whether attributes are resident or nonresident.",ex:"A forensic tool decodes data runs from an MFT record: the first run starts at cluster 1000 for 50 clusters, then jumps to cluster 5000 for 30 more clusters. Together these data runs map the complete fragmented file."},
{term:"Virtual Machine",def:"Software that emulates a computer's hardware environment, allowing another OS (guest) to run on an existing physical computer (host). Useful in forensics for restoring suspect drives and running nonstandard software.",ex:"An investigator creates a VM in VirtualBox, mounts the suspect's forensic drive image as a virtual disk, and boots it. This lets them interact with the suspect's desktop, installed programs, and browsing history without modifying any evidence."},
{term:"Resilient File System (ReFS)",def:"Microsoft's file system introduced in Windows Server 2012 for very large data storage needs. Uses B+-tree structures for fast access, with features for maximized availability, improved integrity, and scalability.",ex:"A cloud storage provider uses ReFS on their Windows Server 2012 R2 systems. When an investigator needs to examine 200 TB of data, ReFS's B+-tree indexing allows targeted searches far faster than traditional NTFS volumes."},
{term:"NTLDR (NT Loader)",def:"A program in the root folder of the system partition that loads the Windows XP operating system. Replaced by Bootmgr.exe in Windows Vista and later versions.",ex:"While examining a Windows XP evidence drive, the investigator checks the NTLDR file's last access timestamp to determine when the computer was last booted \u2014 establishing that the suspect used the machine two hours after the incident."},
{term:"Whole Disk Encryption (WDE)",def:"Software that encrypts each sector of a drive separately, including the boot sector. Features include preboot authentication, full/partial encryption, advanced algorithms, and key management. Must be decrypted before forensic examination.",ex:"A suspect's laptop uses third-party whole disk encryption. The forensic team obtains a court order compelling the suspect to provide the passphrase. Once entered, the entire drive decrypts, revealing emails discussing the fraud scheme."}
];
const quizData=[
{q:"What is the primary database NTFS uses to store and link to files?",opts:["File Allocation Table","Master Boot Record","Master File Table","Boot Configuration Data"],ans:2,exp:"NTFS uses the Master File Table (MFT) as its primary database to store and link to all files on the disk."},
{q:"When a FAT file is deleted, what character replaces the first letter of the filename?",opts:["HEX 00","HEX FF","HEX E5","HEX AA"],ans:2,exp:"When a file is deleted in the FAT file system, the directory entry is marked with the HEX E5 character replacing the first letter of the filename."},
{q:"What are the two components of drive slack?",opts:["File slack and disk slack","RAM slack and file slack","Cluster slack and sector slack","MFT slack and partition slack"],ans:1,exp:"Drive slack is composed of RAM slack (unused space from EOF to end of the last sector) and file slack (unused sectors in the cluster)."},
{q:"Which of these is NOT a requirement for BitLocker?",opts:["TPM microchip v1.2 or newer","TCG-compliant BIOS","Three NTFS partitions","Hard drive boots first"],ans:2,exp:"BitLocker requires TWO NTFS partitions (not three), plus a TPM v1.2+, TCG-compliant BIOS, and the hard drive configured as the first boot device."},
{q:"How many MFT records are reserved for NTFS system files?",opts:["8","10","15","20"],ans:2,exp:"The first 15 records in the MFT are reserved for system files including $MFT, $MFTMirr, $LogFile, $Volume, and others."},
{q:"What replaced NTLDR in Windows Vista and later?",opts:["Boot.ini","Bootmgr.exe","NTDetect.com","Hal.dll"],ans:1,exp:"Microsoft replaced NTLDR with Bootmgr.exe (along with Winload.exe and Winresume.exe) starting with Windows Vista."},
{q:"Where are Windows Registry files primarily stored?",opts:["C:\\Windows\\Registry","C:\\Windows\\System32\\Config","C:\\Users\\Registry","C:\\Boot\\Registry"],ans:1,exp:"Registry files are stored in C:\\Windows\\System32\\Config, with transaction logs (.LOG files) recording changes."},
{q:"What is the correct order of the NTFS boot sequence?",opts:["Kernel loading, POST, Boot loader, User logon","POST, Initial startup, Boot loader, Hardware detection, Kernel loading, User logon","Boot loader, POST, Hardware detection, Kernel loading","User logon, POST, Initial startup, Kernel loading"],ans:1,exp:"The correct order is: POST \u2192 Initial startup \u2192 Boot loader \u2192 Hardware detection and configuration \u2192 Kernel loading \u2192 User logon."},
{q:"What file system uses a B+-tree sort method for fast access to large data sets?",opts:["NTFS","FAT32","exFAT","ReFS"],ans:3,exp:"Resilient File System (ReFS) uses a B+-tree storage engine for fast access to large data sets. It was introduced in Windows Server 2012."},
{q:"What can NTFS alternate data streams be used to do?",opts:["Compress files automatically","Append hidden data to existing files","Encrypt the MFT","Speed up disk defragmentation"],ans:1,exp:"Alternate data streams allow data to be appended to existing files, potentially obscuring evidentiary data. They become an additional file attribute in NTFS."}
];
const matchData=[
{term:"MFT",def:"NTFS database that stores and links to all files on a disk"},
{term:"Drive Slack",def:"Unused cluster space that may contain deleted data fragments"},
{term:"HEX E5",def:"Character that replaces the first letter of a deleted FAT filename"},
{term:"EFS",def:"Public/private key encryption for NTFS files and folders"},
{term:"HKEY",def:"Top-level handle to a category in the Windows Registry"},
{term:"Data Runs",def:"MFT cluster addresses pointing to nonresident file data"}
];
const sortSteps=[
"Power-on Self Test (POST)",
"Initial startup",
"Boot loader",
"Hardware detection and configuration",
"Kernel loading",
"User logon"
];
const tfData=[
{s:"NTFS uses smaller clusters than FAT, resulting in less file slack space.",a:true,exp:"NTFS results in much less file slack space because clusters are smaller for smaller disk drives compared to FAT."},
{s:"When a file is deleted in FAT, the actual data is immediately erased from the disk.",a:false,exp:"When a FAT file is deleted, only the directory entry is marked with HEX E5 and the FAT chain set to 0. The actual data remains on disk until overwritten."},
{s:"BitLocker requires a minimum of three NTFS partitions to function.",a:false,exp:"BitLocker requires TWO NTFS partitions \u2014 a system volume and an active partition with available space."},
{s:"The first 15 records in the MFT are reserved for NTFS system files.",a:true,exp:"Records 0-15 in the MFT are reserved for system files like $MFT, $MFTMirr, $LogFile, $Volume, $AttrDef, and others."},
{s:"Booting a suspect's computer to its hard disk is safe for evidence preservation.",a:false,exp:"Booting to the hard disk overwrites and changes evidentiary data. Always boot to a forensically configured CD, DVD, or USB drive."},
{s:"Starting a Windows XP workstation changes last access timestamps on system files, destroying evidence.",a:true,exp:"When you start a Windows XP NTFS workstation, the last access date and time stamps change to the current date, destroying evidence of when it was last used."},
{s:"Alternate data streams in NTFS can be detected by simply looking at the file size in Windows Explorer.",a:false,exp:"You can only detect an alternate data stream by examining the file's MFT record entry. The ADS data is hidden from normal file browsing."},
{s:"The Windows Registry is a flat text file that stores system preferences.",a:false,exp:"The Registry is a hierarchical DATABASE (not a text file) that stores hardware/software configuration, network connections, user preferences, and setup information."}
];
const scenarioData=[
{text:"You need to examine a suspect's Windows 10 laptop. The machine is powered off. What should you do before turning it on?",choices:[
{t:"Boot it normally to see what's on the desktop",rating:"bad",fb:"Booting normally to the hard disk overwrites evidentiary data and changes timestamps. Never boot a suspect's machine to its own OS."},
{t:"Configure BIOS/UEFI to boot from a forensically prepared USB drive first",rating:"best",fb:"Correct! You must ensure the system boots to a forensically configured device to prevent overwriting or altering evidence on the hard drive."},
{t:"Remove the hard drive and format it for analysis",rating:"bad",fb:"Formatting the drive would destroy all evidence. You should create a forensic image of the drive, never modify the original."}]},
{text:"You've imaged the NTFS drive and opened it in your forensic tool. Where should you look first to get an overview of all files, including deleted ones?",choices:[
{t:"Browse the Recycle Bin folder only",rating:"okay",fb:"The Recycle Bin contains some deleted files, but many are permanently deleted using the del command or by emptying the bin. The MFT is more comprehensive."},
{t:"Examine the Master File Table (MFT) for all file records including deleted entries",rating:"best",fb:"The MFT contains records for ALL files on the disk, including deleted ones. MFT records preserve filenames, timestamps, and cluster locations even after deletion."},
{t:"Search only the unallocated space with keyword searches",rating:"okay",fb:"Keyword searching unallocated space can find evidence, but you'll miss metadata like timestamps and file attributes that the MFT preserves."}]},
{text:"While analyzing the MFT, you notice a JPG file has an unusually large MFT record with an alternate data stream. What does this suggest?",choices:[
{t:"The file is corrupted and should be ignored",rating:"bad",fb:"Alternate data streams are not corruption. They can contain hidden data that may be critical evidence."},
{t:"Additional data has been appended to the file via NTFS alternate data streams, potentially hiding evidence",rating:"best",fb:"Alternate data streams can obscure valuable evidentiary data. The hidden stream could contain stolen data, malware, or other evidence the suspect was trying to conceal."},
{t:"The JPG is just a very high resolution image",rating:"bad",fb:"Image resolution affects file size but not MFT record structure. An ADS in the MFT record indicates hidden data appended to the file."}]},
{text:"The suspect's drive is encrypted with BitLocker. How should you proceed?",choices:[
{t:"Use a brute-force password cracker on the encrypted volume",rating:"bad",fb:"BitLocker with TPM uses strong encryption that makes brute-force impractical. You need the recovery key or passphrase through proper legal channels."},
{t:"Obtain the BitLocker recovery key through legal channels (Active Directory, Microsoft account, or court order) and decrypt the drive",rating:"best",fb:"The proper approach is to obtain the recovery key through legal means. Companies often store BitLocker recovery keys in Active Directory, or you may need a court order to compel the suspect to provide it."},
{t:"Skip the encrypted drive and only analyze unencrypted areas",rating:"okay",fb:"While you can analyze unencrypted metadata, the bulk of evidence is on the encrypted volume. Obtaining the recovery key through proper channels should be your primary strategy."}]}
];
const glossaryData=[
{term:"Alternate Data Streams (ADS)",def:"Ways data can be appended to existing NTFS files, becoming an additional file attribute. Can obscure evidentiary data intentionally or by coincidence."},
{term:"Attribute ID",def:"In NTFS, an MFT record field containing metadata about the file or folder and the file's data or links to the file's data."},
{term:"Boot Configuration Data (BCD)",def:"In Windows Vista and later, a Registry file that controls the boot process, replacing the older Boot.ini file."},
{term:"Boot.ini",def:"A Windows XP file that specifies the Windows path installation and a variety of other startup options."},
{term:"Bootstrap Process",def:"Information contained in ROM that a computer accesses during startup; tells the computer how to access the OS and hard drive."},
{term:"Clusters",def:"Storage allocation units composed of groups of sectors. The OS assigns cluster positions to files when storing data."},
{term:"CMOS",def:"Complementary Metal Oxide Semiconductor \u2014 stores system configuration and date/time information when power is off."},
{term:"Data Runs",def:"Cluster addresses in MFT records pointing to where nonresident file data is stored on the drive's partition."},
{term:"Drive Slack",def:"Unused space in a cluster between the end of an active file and end of the cluster. Made up of RAM slack and file slack."},
{term:"Encrypting File System (EFS)",def:"A public/private key encryption method first used in Windows 2000 on NTFS-formatted disks."},
{term:"File Allocation Table (FAT)",def:"The original Microsoft file structure database, written to the outermost track of a disk. Variations include FAT12, FAT16, and FAT32."},
{term:"File Slack",def:"Unused space from the end of the last sector used by a file to the end of the last cluster assigned to the file."},
{term:"Geometry",def:"A disk drive's internal organization of platters, tracks, and sectors."},
{term:"Hal.dll",def:"Hardware Abstraction Layer dynamic link library \u2014 allows the OS kernel to communicate with hardware."},
{term:"HKEY",def:"Handle to a key \u2014 a top-level category in the Windows Registry (e.g., HKEY_LOCAL_MACHINE, HKEY_CURRENT_USER)."},
{term:"Hives",def:"Groups of Registry keys, subkeys, and values stored as files on disk. Each hive has a corresponding transaction log."},
{term:"Logical Cluster Numbers (LCNs)",def:"Numbers the MFT uses to refer to specific physical locations on a disk partition for nonresident file data."},
{term:"Master Boot Record (MBR)",def:"Boot disk file containing information about partitions on a disk, their locations, sizes, and other important items."},
{term:"Master File Table (MFT)",def:"The NTFS database that stores and links to all files. Contains access rights, date/time stamps, system attributes, and file information."},
{term:"Metadata",def:"In NTFS, information stored in the MFT including file attributes, timestamps, and system data."},
{term:"NTFS (NT File System)",def:"Microsoft's file system replacing FAT. Features smaller clusters, Unicode support, journaling, security features, and the MFT."},
{term:"NTLDR (NT Loader)",def:"A program in the root folder of the Windows XP system partition that loads the OS. Replaced by Bootmgr.exe in Vista+."},
{term:"Ntoskrnl.exe",def:"The kernel for the Windows NT family of operating systems."},
{term:"One-Time Passphrase",def:"A password used once to access special accounts or decryption utilities for encrypted drives, then expires."},
{term:"Pagefile.sys",def:"At startup, data and instruction code are moved in and out of this file to optimize physical RAM availability."},
{term:"Partition Boot Sector",def:"The first data set on an NTFS disk, starting at sector 0 and expanding up to 16 sectors."},
{term:"RAM Slack",def:"Unused space between the end of file (EOF) and the end of the last sector used by the active file in a cluster."},
{term:"Recovery Certificate",def:"A method NTFS uses so a network administrator can recover EFS-encrypted files if the user loses their private key."},
{term:"Resilient File System (ReFS)",def:"A file system for Windows Server 2012+ designed for large-scale data storage with B+-tree indexing and improved integrity."},
{term:"Virtual Cluster Number (VCN)",def:"Offset values from the previous LCN data run, used to map fragmented nonresident files across an NTFS partition."},
{term:"Virtual Machine",def:"Software that emulates hardware, letting another OS (guest) run on a physical computer (host). Used forensically to safely examine suspect drives."},
{term:"Whole Disk Encryption (WDE)",def:"Software that encrypts each sector of a drive separately, including the boot sector. Must be decrypted before forensic examination."}
];

// NAV
const navBtns=document.querySelectorAll('.nav-btn');const sections=document.querySelectorAll('.section');
navBtns.forEach(b=>b.addEventListener('click',()=>{navBtns.forEach(n=>n.classList.remove('active'));b.classList.add('active');sections.forEach(s=>s.classList.remove('active'));document.getElementById(b.dataset.section).classList.add('active');updProg()}));
// TABS
document.querySelectorAll('.tab-btn').forEach(b=>b.addEventListener('click',()=>{document.querySelectorAll('.tab-btn').forEach(t=>t.classList.remove('active'));b.classList.add('active');document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));document.getElementById('tab-'+b.dataset.tab).classList.add('active')}));
// ACCORDION
document.querySelectorAll('.acc-hd').forEach(h=>h.addEventListener('click',()=>{const item=h.parentElement;const body=h.nextElementSibling;const isOpen=item.classList.contains('open');document.querySelectorAll('.acc-item').forEach(a=>{a.classList.remove('open');a.querySelector('.acc-bd').style.maxHeight=null;a.querySelector('.acc-hd').setAttribute('aria-expanded','false')});if(!isOpen){item.classList.add('open');body.style.maxHeight=body.scrollHeight+'px';h.setAttribute('aria-expanded','true')}updProg()}));
// THEME
document.getElementById('themeToggle').addEventListener('click',()=>{const d=document.documentElement;const dark=d.getAttribute('data-theme')==='dark';d.setAttribute('data-theme',dark?'':'dark');document.getElementById('themeToggle').textContent=dark?'\u{1F319}':'\u{2600}\u{FE0F}'});
// PROGRESS
function updProg(){const opened=document.querySelectorAll('.acc-item.open').length;const total=document.querySelectorAll('.acc-item').length;const vis=document.querySelectorAll('.nav-btn.active')[0]?.dataset.section;let p=0;if(vis==='objectives')p=5;else if(vis==='content')p=10+Math.round((opened/total)*40);else if(vis==='activities')p=55;else if(vis==='flashcards')p=65;else if(vis==='quiz')p=75;else if(vis==='glossary')p=85;else if(vis==='videos')p=95;document.getElementById('progressBar').style.width=p+'%';document.getElementById('progressText').textContent=p+'%'}

// FLASHCARDS
let fcIdx=0,fcFace=0;
function showFC(){const c=flashcards[fcIdx];document.getElementById('fcTerm').textContent=c.term;document.getElementById('fcDef').textContent=c.def;document.getElementById('fcEx').innerHTML='<em class="fc-ex-pre">Real-World Example:</em>'+c.ex;document.getElementById('fcCounter').textContent=`Card ${fcIdx+1} of ${flashcards.length}`;fcFace=0;updPrismRot();updDots()}
function updPrismRot(){document.getElementById('fcPrism').style.transform=`rotateX(${fcFace*120}deg)`}
function updDots(){document.querySelectorAll('.fc-dot-grp').forEach((g,i)=>{g.classList.toggle('active',i===fcFace);const d=g.querySelector('.fc-dot');d.className='fc-dot';if(i===fcFace){d.classList.add(i===0?'a-term':i===1?'a-def':'a-ex')}})}
document.getElementById('fcViewport').addEventListener('click',()=>{fcFace=(fcFace+1)%3;updPrismRot();updDots()});
document.getElementById('fcFlip').addEventListener('click',()=>{fcFace=(fcFace+1)%3;updPrismRot();updDots()});
document.getElementById('fcPrev').addEventListener('click',()=>{fcIdx=(fcIdx-1+flashcards.length)%flashcards.length;showFC()});
document.getElementById('fcNext').addEventListener('click',()=>{fcIdx=(fcIdx+1)%flashcards.length;showFC()});
document.querySelectorAll('.fc-dot').forEach(d=>d.addEventListener('click',()=>{fcFace=parseInt(d.dataset.face);updPrismRot();updDots()}));
document.getElementById('fcViewport').addEventListener('keydown',e=>{if(e.key==='ArrowRight'){fcIdx=(fcIdx+1)%flashcards.length;showFC()}else if(e.key==='ArrowLeft'){fcIdx=(fcIdx-1+flashcards.length)%flashcards.length;showFC()}else if(e.key==='Enter'||e.key===' '){e.preventDefault();fcFace=(fcFace+1)%3;updPrismRot();updDots()}});
showFC();

// QUIZ
let qIdx=0,qSel=-1,qScore=0,qAns=false;
function showQ(){const q=quizData[qIdx];document.getElementById('quizProgress').textContent=`Question ${qIdx+1} of ${quizData.length}`;document.getElementById('quizQ').textContent=q.q;const c=document.getElementById('quizOpts');c.innerHTML='';q.opts.forEach((o,i)=>{const d=document.createElement('div');d.className='quiz-opt';d.setAttribute('role','radio');d.setAttribute('tabindex','0');d.innerHTML=`<span class="ltr">${String.fromCharCode(65+i)}</span><span>${o}</span>`;d.addEventListener('click',()=>selQ(i));d.addEventListener('keydown',e=>{if(e.key==='Enter')selQ(i)});c.appendChild(d)});document.getElementById('quizFb').className='quiz-fb';document.getElementById('quizFb').textContent='';document.getElementById('quizNext').style.display='none';document.getElementById('quizSubmit').style.display='';qSel=-1;qAns=false}
function selQ(i){if(qAns)return;document.querySelectorAll('.quiz-opt').forEach((o,x)=>{o.classList.toggle('selected',x===i)});qSel=i}
document.getElementById('quizSubmit').addEventListener('click',()=>{if(qSel===-1||qAns)return;qAns=true;const q=quizData[qIdx];const opts=document.querySelectorAll('.quiz-opt');opts.forEach((o,i)=>{if(i===q.ans)o.classList.add('correct');if(i===qSel&&i!==q.ans)o.classList.add('incorrect')});const fb=document.getElementById('quizFb');if(qSel===q.ans){fb.className='quiz-fb ok';fb.textContent='\u2714 Correct! '+q.exp;qScore++}else{fb.className='quiz-fb no';fb.textContent='\u2718 Incorrect. '+q.exp}document.getElementById('quizSubmit').style.display='none';document.getElementById('quizNext').style.display=''});
document.getElementById('quizNext').addEventListener('click',()=>{qIdx++;if(qIdx>=quizData.length){document.getElementById('quizArea').style.display='none';const r=document.getElementById('quizResults');r.style.display='';document.getElementById('finalScore').textContent=qScore+'/'+quizData.length;const pct=qScore/quizData.length;document.getElementById('scoreMsg').textContent=pct>=.8?'Excellent work!':pct>=.6?'Good effort!':'Keep studying!'}else showQ()});
document.getElementById('quizRestart').addEventListener('click',()=>{qIdx=0;qScore=0;document.getElementById('quizArea').style.display='';document.getElementById('quizResults').style.display='none';showQ()});showQ();

// MATCHING
let mSelTerm=null,mSelDef=null,mMatched=0;
function initMatch(){mSelTerm=null;mSelDef=null;mMatched=0;const tC=document.getElementById('matchTerms');const dC=document.getElementById('matchDefs');tC.innerHTML='';dC.innerHTML='';const shuffled=[...matchData].map((m,i)=>({...m,origIdx:i}));matchData.forEach((m,i)=>{const d=document.createElement('div');d.className='match-item';d.textContent=m.term;d.addEventListener('click',()=>pickTerm(d,i));tC.appendChild(d)});const sh=[...shuffled].sort(()=>Math.random()-.5);sh.forEach(m=>{const d=document.createElement('div');d.className='match-item';d.textContent=m.def;d.dataset.origIdx=m.origIdx;d.addEventListener('click',()=>pickDef(d,m.origIdx));dC.appendChild(d)});
document.getElementById('matchScore').textContent=`Matched: 0 / ${matchData.length}`}
function pickTerm(el,i){if(el.classList.contains('matched'))return;document.querySelectorAll('#matchTerms .match-item').forEach(e=>e.classList.remove('sel'));el.classList.add('sel');mSelTerm=i;if(mSelDef!==null)checkMatch()}
function pickDef(el,i){if(el.classList.contains('matched'))return;document.querySelectorAll('#matchDefs .match-item').forEach(e=>e.classList.remove('sel'));el.classList.add('sel');mSelDef=i;if(mSelTerm!==null)checkMatch()}
function checkMatch(){if(mSelTerm===mSelDef){document.querySelectorAll('#matchTerms .match-item')[mSelTerm].classList.add('matched');document.querySelectorAll('#matchTerms .match-item')[mSelTerm].classList.remove('sel');document.querySelectorAll('#matchDefs .match-item').forEach(e=>{if(parseInt(e.dataset.origIdx)===mSelDef){e.classList.add('matched');e.classList.remove('sel')}});mMatched++;document.getElementById('matchScore').textContent=mMatched===matchData.length?'\u{1F389} All matched! Great work!':`Matched: ${mMatched} / ${matchData.length}`}else{document.querySelectorAll('.match-item.sel').forEach(e=>{e.classList.add('wrong');e.classList.remove('sel');setTimeout(()=>e.classList.remove('wrong'),500)})}mSelTerm=null;mSelDef=null}
document.getElementById('matchReset').addEventListener('click',initMatch);initMatch();

// SORTING
function initSort(){const ul=document.getElementById('sortList');ul.innerHTML='';const sh=[...sortSteps].sort(()=>Math.random()-.5);sh.forEach((s,i)=>{const li=document.createElement('li');li.className='sort-item';li.draggable=true;li.innerHTML=`<span class="grip" aria-hidden="true">&#x283F;</span><span class="s-num">${i+1}</span><span>${s}</span>`;li.addEventListener('dragstart',()=>li.classList.add('dragging'));li.addEventListener('dragend',()=>{li.classList.remove('dragging');updSN()});li.addEventListener('dragover',e=>{e.preventDefault();li.classList.add('over')});li.addEventListener('dragleave',()=>li.classList.remove('over'));li.addEventListener('drop',e=>{e.preventDefault();li.classList.remove('over');const dr=ul.querySelector('.dragging');if(dr&&dr!==li)ul.insertBefore(dr,li)});ul.appendChild(li)});document.getElementById('sortFeedback').textContent='';document.querySelectorAll('.sort-item').forEach(i=>i.classList.remove('correct-pos','wrong-pos'))}
function updSN(){document.querySelectorAll('.sort-item .s-num').forEach((n,i)=>n.textContent=i+1)}
document.getElementById('sortCheck').addEventListener('click',()=>{const items=document.querySelectorAll('.sort-item');let c=0;items.forEach((it,i)=>{const t=it.querySelector('span:last-child').textContent;if(t===sortSteps[i]){it.classList.add('correct-pos');it.classList.remove('wrong-pos');c++}else{it.classList.add('wrong-pos');it.classList.remove('correct-pos')}});document.getElementById('sortFeedback').style.color=c===sortSteps.length?'var(--ok)':'var(--hi)';document.getElementById('sortFeedback').textContent=c===sortSteps.length?'\u{1F389} Perfect order!':c+' of '+sortSteps.length+' correct. Keep trying!'});
document.getElementById('sortReset').addEventListener('click',initSort);initSort();

// TRUE/FALSE
let tfA=0,tfC=0;function initTF(){tfA=0;tfC=0;const c=document.getElementById('tfContainer');c.innerHTML='';tfData.forEach((q,i)=>{const d=document.createElement('div');d.className='tf-card';d.id='tf-'+i;d.innerHTML=`<div class="tf-statement">${q.s}</div><div class="tf-btns"><button class="tf-btn" data-i="${i}" data-a="true">\u2714 True</button><button class="tf-btn" data-i="${i}" data-a="false">\u2718 False</button></div><div class="tf-result" id="tf-r-${i}"></div>`;c.appendChild(d)});document.querySelectorAll('.tf-btn').forEach(b=>b.addEventListener('click',hTF));updTFS()}
function hTF(e){const i=parseInt(e.target.dataset.i),ans=e.target.dataset.a==='true',q=tfData[i],card=document.getElementById('tf-'+i),r=document.getElementById('tf-r-'+i);if(card.classList.contains('answered-true')||card.classList.contains('answered-false'))return;tfA++;const ok=ans===q.a;if(ok)tfC++;card.classList.add(ok?'answered-true':'answered-false');card.querySelectorAll('.tf-btn').forEach(b=>b.disabled=true);r.className='tf-result '+(ok?'ok':'no');r.textContent=(ok?'\u2714 Correct! ':'\u2718 Incorrect. ')+q.exp;updTFS()}
function updTFS(){document.getElementById('tfScore').textContent=tfA?`Score: ${tfC} / ${tfA} correct`:'Answer each statement to test your knowledge.'}initTF();

// SCENARIO
let sgS=0,sgSc=0;function initSG(){sgS=0;sgSc=0;document.getElementById('sgResult').style.display='none';document.getElementById('sgBox').style.display='';showSGS()}
function showSGS(){const s=scenarioData[sgS],dots=document.getElementById('sgDots');dots.innerHTML='';scenarioData.forEach((_,i)=>{const d=document.createElement('div');d.className='sg-dot'+(i<sgS?' done':'')+(i===sgS?' active':'');dots.appendChild(d)});document.getElementById('sgLabel').textContent=`Step ${sgS+1} of ${scenarioData.length}`;document.getElementById('sgText').textContent=s.text;const cc=document.getElementById('sgChoices');cc.innerHTML='';cc.style.display='';s.choices.forEach((ch,i)=>{const d=document.createElement('div');d.className='sg-choice';d.textContent=ch.t;d.addEventListener('click',()=>sgP(i));cc.appendChild(d)});document.getElementById('sgFeedback').style.display='none';document.getElementById('sgNext').style.display='none'}
function sgP(i){const s=scenarioData[sgS],ch=s.choices[i];document.querySelectorAll('.sg-choice').forEach((c,x)=>{c.style.pointerEvents='none';c.classList.add(s.choices[x].rating)});if(ch.rating==='best')sgSc+=2;else if(ch.rating==='okay')sgSc+=1;const fb=document.getElementById('sgFeedback');fb.style.display='block';fb.style.background=ch.rating==='best'?'rgba(45,106,79,.1)':ch.rating==='okay'?'rgba(233,196,106,.15)':'rgba(196,69,54,.1)';fb.style.color=ch.rating==='best'?'var(--ok)':ch.rating==='okay'?'#8B6914':'var(--hi)';fb.textContent=(ch.rating==='best'?'\u2714 Best choice! ':ch.rating==='okay'?'\u26A0 Acceptable, but not ideal. ':'\u2718 Not recommended. ')+ch.fb;document.getElementById('sgNext').style.display=''}
document.getElementById('sgNext').addEventListener('click',()=>{sgS++;if(sgS>=scenarioData.length){const r=document.getElementById('sgResult');r.style.display='';r.innerHTML=`<div class="score-circle"><span class="score-num">${sgSc}/${scenarioData.length*2}</span><span class="score-lbl">points</span></div><h3>${sgSc>=scenarioData.length*1.5?'Excellent investigator!':sgSc>=scenarioData.length?'Good instincts!':'Needs more practice.'}</h3><p style="color:var(--tx2);margin:12px 0 20px">Review Windows forensics procedures in the lesson.</p><button class="btn pri" onclick="initSG()">Try Again</button>`;document.getElementById('sgBox').style.display='none'}else showSGS()});initSG();

// GLOSSARY
function renderGlo(f=''){const l=document.getElementById('gloList');l.innerHTML='';const fl=glossaryData.filter(g=>g.term.toLowerCase().includes(f.toLowerCase())||g.def.toLowerCase().includes(f.toLowerCase()));if(!fl.length){l.innerHTML='<p style="color:var(--tx2);padding:20px;text-align:center">No matching terms.</p>';return}fl.forEach(g=>{const d=document.createElement('div');d.className='glo-item';d.innerHTML=`<div class="glo-term">${g.term}</div><div class="glo-def">${g.def}</div>`;l.appendChild(d)})}
document.getElementById('gloSearch').addEventListener('input',e=>renderGlo(e.target.value));renderGlo();updProg();
</script>
</body>
</html>
