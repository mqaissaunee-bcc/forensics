<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 11 &mdash; E-mail and Social Media Investigations</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700;900&family=Source+Sans+3:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap');
:root{--bg0:#F4F0EB;--bg1:#FFFFFF;--bg2:#EDE7E0;--tx0:#1A1A2E;--tx1:#4A4A5A;--tx2:#7A7A8A;--ac:#0D5C63;--ac2:#14919B;--acG:rgba(13,92,99,.12);--hi:#C44536;--hi2:#E76F51;--ok:#2D6A4F;--ok2:#52B788;--warn:#E9C46A;--bdr:#D5CEC7;--shd:0 2px 16px rgba(26,26,46,.06);--shd2:0 8px 32px rgba(26,26,46,.12);--r:12px;--rs:8px;--t:.3s cubic-bezier(.4,0,.2,1);--fH:'Merriweather',Georgia,serif;--fB:'Source Sans 3','Segoe UI',sans-serif;--fM:'JetBrains Mono','Courier New',monospace}
[data-theme="dark"]{--bg0:#0F1419;--bg1:#1A2028;--bg2:#242D38;--tx0:#E8E6E3;--tx1:#B0ADA8;--tx2:#7A7872;--ac:#14919B;--ac2:#44C7D0;--acG:rgba(20,145,155,.15);--hi:#E76F51;--hi2:#F4A261;--ok:#52B788;--ok2:#95D5B2;--bdr:#2E3A47;--shd:0 2px 16px rgba(0,0,0,.3);--shd2:0 8px 32px rgba(0,0,0,.5)}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}html{scroll-behavior:smooth;font-size:16px}body{font-family:var(--fB);background:var(--bg0);color:var(--tx0);line-height:1.7;transition:background var(--t),color var(--t)}
.skip-link{position:absolute;top:-100%;left:50%;transform:translateX(-50%);background:var(--ac);color:#fff;padding:12px 24px;border-radius:0 0 var(--rs) var(--rs);z-index:10000;font-weight:600;text-decoration:none;transition:top .2s}.skip-link:focus{top:0}
::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:var(--bg2)}::-webkit-scrollbar-thumb{background:var(--ac);border-radius:4px}
.hero{background:linear-gradient(135deg,#0D5C63 0%,#14919B 50%,#0D5C63 100%);padding:60px 24px 50px;text-align:center;position:relative;overflow:hidden}.hero::before{content:'';position:absolute;inset:0;background:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")}.hero-badge{display:inline-block;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.25);padding:6px 20px;border-radius:50px;font-family:var(--fM);font-size:.8rem;color:rgba(255,255,255,.9);letter-spacing:2px;text-transform:uppercase;margin-bottom:20px;position:relative}.hero h1{font-family:var(--fH);font-size:clamp(1.8rem,4vw,2.8rem);font-weight:900;color:#fff;line-height:1.3;max-width:800px;margin:0 auto 12px;position:relative}.hero p{font-size:1.1rem;color:rgba(255,255,255,.85);max-width:620px;margin:0 auto;position:relative}
.progress-container{position:sticky;top:0;z-index:1000;background:var(--bg1);border-bottom:1px solid var(--bdr);padding:10px 24px;display:flex;align-items:center;gap:16px;transition:background var(--t)}.progress-bar-wrap{flex:1;height:8px;background:var(--bg2);border-radius:4px;overflow:hidden}.progress-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--ac),var(--ac2));border-radius:4px;transition:width .5s ease}.progress-text{font-family:var(--fM);font-size:.8rem;color:var(--tx2);min-width:42px;text-align:right}.theme-toggle{background:var(--bg2);border:1px solid var(--bdr);border-radius:50px;padding:6px 14px;cursor:pointer;font-size:1.1rem;color:var(--tx0);transition:all var(--t);display:flex;align-items:center;gap:6px}.theme-toggle:hover,.theme-toggle:focus-visible{background:var(--ac);color:#fff}
.nav-bar{background:var(--bg1);border-bottom:1px solid var(--bdr);padding:0 24px;display:flex;overflow-x:auto;gap:4px;scrollbar-width:none;transition:background var(--t)}.nav-bar::-webkit-scrollbar{display:none}.nav-btn{background:none;border:none;padding:14px 18px;font-family:var(--fB);font-size:.85rem;font-weight:600;color:var(--tx2);cursor:pointer;white-space:nowrap;border-bottom:3px solid transparent;transition:all var(--t)}.nav-btn:hover,.nav-btn:focus-visible{color:var(--ac)}.nav-btn.active{color:var(--ac);border-bottom-color:var(--ac)}
.container{max-width:960px;margin:0 auto;padding:32px 24px 80px}.section{display:none;animation:fadeIn .4s ease}.section.active{display:block}@keyframes fadeIn{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}h2{font-family:var(--fH);font-size:1.8rem;font-weight:900;color:var(--tx0);margin-bottom:8px;display:flex;align-items:center;gap:12px}h2 .icon{font-size:1.4rem}.section-sub{color:var(--tx2);font-size:1rem;margin-bottom:28px}h3{font-family:var(--fH);font-size:1.2rem;font-weight:700;margin:24px 0 12px;color:var(--tx0)}
.card{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--r);padding:24px;margin-bottom:16px;box-shadow:var(--shd);transition:all var(--t)}
.obj-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-top:20px}.obj-card{background:var(--bg1);border:1px solid var(--bdr);border-left:4px solid var(--ac);border-radius:var(--rs);padding:20px;display:flex;align-items:flex-start;gap:14px;box-shadow:var(--shd);transition:all var(--t)}.obj-card:hover{border-left-color:var(--hi);transform:translateX(4px)}.obj-num{font-family:var(--fM);font-size:.75rem;font-weight:600;color:#fff;background:var(--ac);width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.obj-text{font-size:.95rem;color:var(--tx1)}
.acc-item{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--r);margin-bottom:12px;overflow:hidden;box-shadow:var(--shd)}.acc-hd{width:100%;display:flex;align-items:center;justify-content:space-between;padding:20px 24px;background:none;border:none;cursor:pointer;font-family:var(--fH);font-size:1.05rem;font-weight:700;color:var(--tx0);text-align:left;transition:all var(--t);gap:12px}.acc-hd:hover,.acc-hd:focus-visible{background:var(--acG)}.acc-hd .chv{font-size:1.2rem;transition:transform var(--t);flex-shrink:0;color:var(--ac)}.acc-item.open .chv{transform:rotate(180deg)}.acc-bd{max-height:0;overflow:hidden;transition:max-height .4s ease}.acc-ct{padding:0 24px 24px;color:var(--tx1);line-height:1.8}.acc-ct p{margin-bottom:12px}.acc-ct strong{color:var(--tx0)}.kt{display:inline;background:var(--acG);color:var(--ac);padding:2px 8px;border-radius:4px;font-weight:600;font-size:.9rem}.info-box{background:var(--bg2);border-left:4px solid var(--ac);padding:16px 20px;border-radius:0 var(--rs) var(--rs) 0;margin:16px 0;font-size:.95rem}.info-box.warn{border-left-color:var(--hi)}
.compare-tbl{width:100%;border-collapse:collapse;margin:16px 0;font-size:.9rem}.compare-tbl th,.compare-tbl td{padding:10px 14px;border:1px solid var(--bdr);text-align:left}.compare-tbl th{background:var(--acG);color:var(--ac);font-weight:700;font-family:var(--fH);font-size:.85rem}.compare-tbl td{background:var(--bg1)}
.tab-row{display:flex;gap:4px;margin-bottom:20px;overflow-x:auto;scrollbar-width:none}.tab-row::-webkit-scrollbar{display:none}.tab-btn{padding:10px 20px;border:1px solid var(--bdr);border-radius:var(--rs);background:var(--bg1);cursor:pointer;font-family:var(--fB);font-weight:600;font-size:.85rem;color:var(--tx2);transition:all var(--t);white-space:nowrap}.tab-btn:hover{border-color:var(--ac);color:var(--ac)}.tab-btn.active{background:var(--ac);color:#fff;border-color:var(--ac)}.tab-panel{display:none}.tab-panel.active{display:block}
.btn{padding:10px 24px;border-radius:var(--rs);font-family:var(--fB);font-weight:600;font-size:.9rem;cursor:pointer;border:1px solid var(--bdr);transition:all var(--t)}.btn.pri{background:var(--ac);color:#fff;border-color:var(--ac)}.btn.pri:hover{background:var(--ac2)}.btn.sec{background:var(--bg2);color:var(--tx0)}.btn.sec:hover{border-color:var(--ac)}.btn-row{display:flex;gap:10px;margin-top:16px}
.fc-stats{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;font-family:var(--fM);font-size:.85rem;color:var(--tx2)}
.fc-viewport{perspective:1200px;width:100%;max-width:620px;height:300px;margin:0 auto 14px;cursor:pointer}
.fc-prism{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .7s cubic-bezier(.4,0,.2,1)}
.fc-face{position:absolute;inset:0;backface-visibility:hidden;border-radius:var(--r);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 28px;text-align:center;overflow-y:auto}
.fc-face--term{background:linear-gradient(135deg,var(--ac),var(--ac2));color:#fff;transform:rotateX(0deg) translateZ(87px)}
.fc-face--def{background:var(--bg1);border:2px solid var(--ac);color:var(--tx0);transform:rotateX(-120deg) translateZ(87px)}
.fc-face--example{background:linear-gradient(135deg,#6B4C9A,#9B6DFF);color:#fff;transform:rotateX(-240deg) translateZ(87px)}
[data-theme="dark"] .fc-face--example{background:linear-gradient(135deg,#4A3070,#7B4FCC)}
.fc-lbl{font-family:var(--fM);font-size:.65rem;letter-spacing:2.5px;text-transform:uppercase;margin-bottom:14px;display:flex;align-items:center;gap:8px}
.fc-lbl-icon{font-size:1rem}.fc-main{font-size:1.15rem;line-height:1.6;font-weight:600;max-width:90%}.fc-face--def .fc-main,.fc-face--example .fc-main{font-size:1rem;font-weight:400}.fc-ex-pre{display:block;font-size:.75rem;text-transform:uppercase;letter-spacing:2px;margin-bottom:8px;opacity:.8;font-style:normal}.fc-hint{font-size:.8rem;opacity:.7;margin-top:auto;padding-top:12px}
.fc-dots{display:flex;justify-content:center;gap:16px;margin-bottom:18px}.fc-dot-grp{display:flex;flex-direction:column;align-items:center;gap:4px;cursor:pointer}.fc-dot{width:14px;height:14px;border-radius:50%;border:2px solid var(--bdr);background:var(--bg2);cursor:pointer;transition:all var(--t)}.fc-dot-grp.active .fc-dot{transform:scale(1.2)}.fc-dot.a-term{background:var(--ac);border-color:var(--ac)}.fc-dot.a-def{background:var(--bg1);border-color:var(--ac)}.fc-dot.a-ex{background:#6B4C9A;border-color:#6B4C9A}.fc-dot-lbl{font-family:var(--fM);font-size:.6rem;color:var(--tx2);text-transform:uppercase;letter-spacing:1px}
.fc-ctrls{display:flex;justify-content:center;gap:12px;flex-wrap:wrap}.fc-btn{padding:10px 22px;border-radius:var(--rs);border:1px solid var(--bdr);background:var(--bg1);color:var(--tx0);font-family:var(--fB);font-weight:600;font-size:.9rem;cursor:pointer;transition:all var(--t)}.fc-btn:hover{border-color:var(--ac);color:var(--ac)}.fc-btn.pri{background:var(--ac);color:#fff;border-color:var(--ac)}.fc-btn.pri:hover{background:var(--ac2)}.fc-btn.flip{background:var(--bg2)}
.quiz-progress{font-family:var(--fM);font-size:.82rem;color:var(--tx2);margin-bottom:12px}.quiz-q{font-family:var(--fH);font-size:1.15rem;font-weight:700;margin-bottom:20px;line-height:1.5}.quiz-opts{display:flex;flex-direction:column;gap:10px;margin-bottom:16px}.quiz-opt{display:flex;align-items:center;gap:12px;padding:14px 18px;background:var(--bg2);border:2px solid var(--bdr);border-radius:var(--rs);cursor:pointer;transition:all var(--t)}.quiz-opt:hover{border-color:var(--ac)}.quiz-opt.selected{border-color:var(--ac);background:var(--acG)}.quiz-opt.correct{border-color:var(--ok);background:rgba(45,106,79,.1)}.quiz-opt.incorrect{border-color:var(--hi);background:rgba(196,69,54,.1)}.quiz-opt .ltr{font-family:var(--fM);font-size:.8rem;font-weight:600;color:#fff;background:var(--ac);width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.quiz-fb{min-height:24px;font-size:.95rem;padding:8px 0;line-height:1.6}.quiz-fb.ok{color:var(--ok)}.quiz-fb.no{color:var(--hi)}.score-circle{width:100px;height:100px;border-radius:50%;background:var(--acG);display:flex;flex-direction:column;align-items:center;justify-content:center;margin:0 auto 20px;border:3px solid var(--ac)}.score-num{font-family:var(--fM);font-size:1.4rem;font-weight:700;color:var(--ac)}.score-lbl{font-size:.7rem;color:var(--tx2)}
.match-container{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:16px}.match-col-title{font-family:var(--fM);font-size:.75rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--tx2);margin-bottom:10px;text-align:center}.match-item{padding:12px 16px;background:var(--bg2);border:2px solid var(--bdr);border-radius:var(--rs);cursor:pointer;transition:all var(--t);margin-bottom:8px;font-size:.9rem;text-align:center}.match-item:hover{border-color:var(--ac)}.match-item.sel{border-color:var(--ac);background:var(--acG);font-weight:600}.match-item.matched{border-color:var(--ok);background:rgba(45,106,79,.1);cursor:default;opacity:.7}.match-item.wrong{border-color:var(--hi);background:rgba(196,69,54,.1);animation:shake .3s}@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}.match-score{text-align:center;font-family:var(--fM);font-size:.85rem;color:var(--tx2);margin-top:10px}
.sort-list{list-style:none;padding:0}.sort-item{display:flex;align-items:center;gap:12px;padding:14px 18px;background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--rs);margin-bottom:8px;cursor:grab;transition:all var(--t);font-size:.9rem}.sort-item:active{cursor:grabbing;background:var(--acG)}.sort-item.over{border-color:var(--ac);border-style:dashed}.sort-item.correct-pos{border-color:var(--ok);background:rgba(45,106,79,.08)}.sort-item.wrong-pos{border-color:var(--hi);background:rgba(196,69,54,.08)}.grip{color:var(--tx2);font-size:1.1rem;cursor:grab}.s-num{font-family:var(--fM);font-size:.75rem;color:#fff;background:var(--ac);width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.tf-card{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--rs);padding:18px 20px;margin-bottom:12px;box-shadow:var(--shd)}.tf-statement{font-size:.95rem;margin-bottom:12px;line-height:1.6}.tf-btns{display:flex;gap:8px}.tf-btn{padding:8px 18px;border:1px solid var(--bdr);border-radius:var(--rs);background:var(--bg2);cursor:pointer;font-family:var(--fB);font-weight:600;font-size:.85rem;transition:all var(--t)}.tf-btn:hover{border-color:var(--ac);color:var(--ac)}.answered-true .tf-btns .tf-btn,.answered-false .tf-btns .tf-btn{opacity:.5;cursor:default}.tf-result{margin-top:10px;font-size:.9rem;line-height:1.6;display:none}.tf-result.ok,.tf-result.no{display:block}.tf-result.ok{color:var(--ok)}.tf-result.no{color:var(--hi)}
.sg-box{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--r);padding:28px;box-shadow:var(--shd)}.sg-progress-dots{display:flex;justify-content:center;gap:8px;margin-bottom:16px}.sg-dot{width:12px;height:12px;border-radius:50%;background:var(--bdr);transition:all var(--t)}.sg-dot.active{background:var(--ac);transform:scale(1.3)}.sg-dot.done{background:var(--ok)}.sg-lbl{font-family:var(--fM);font-size:.75rem;color:var(--tx2);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px}.sg-text{font-size:1.05rem;line-height:1.7;margin-bottom:20px}.sg-choices{display:flex;flex-direction:column;gap:10px}.sg-choice{padding:14px 18px;background:var(--bg2);border:2px solid var(--bdr);border-radius:var(--rs);cursor:pointer;font-size:.95rem;transition:all var(--t)}.sg-choice:hover{border-color:var(--ac)}.sg-choice.best{border-color:var(--ok);background:rgba(45,106,79,.1)}.sg-choice.okay{border-color:var(--warn);background:rgba(233,196,106,.1)}.sg-choice.bad{border-color:var(--hi);background:rgba(196,69,54,.1)}.sg-feedback{margin-top:16px;padding:14px 18px;border-radius:var(--rs);font-size:.95rem;line-height:1.6}
.glo-search{width:100%;padding:14px 20px;border:2px solid var(--bdr);border-radius:var(--rs);font-family:var(--fB);font-size:1rem;background:var(--bg1);color:var(--tx0);margin-bottom:16px;transition:border-color var(--t)}.glo-search:focus{outline:none;border-color:var(--ac)}.glo-item{padding:16px 20px;background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--rs);margin-bottom:8px}.glo-term{font-family:var(--fH);font-weight:700;font-size:1rem;color:var(--ac);margin-bottom:4px}.glo-def{font-size:.92rem;color:var(--tx1);line-height:1.6}
.vid-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.vid-card{background:var(--bg1);border:1px solid var(--bdr);border-radius:var(--r);overflow:hidden;box-shadow:var(--shd);transition:all var(--t)}.vid-card:hover{box-shadow:var(--shd2);transform:translateY(-3px)}.vid-embed{width:100%;aspect-ratio:16/9;border:none}.vid-info{padding:16px}.vid-title{font-family:var(--fH);font-weight:700;font-size:.95rem;margin-bottom:6px}.vid-desc{font-size:.85rem;color:var(--tx2);line-height:1.5}
@media(max-width:600px){.hero{padding:40px 16px 36px}.hero h1{font-size:1.5rem}.container{padding:20px 16px 60px}.fc-viewport{height:260px}.match-container{grid-template-columns:1fr}.obj-grid{grid-template-columns:1fr}.vid-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<a class="skip-link" href="#main">Skip to main content</a>

<header class="hero" role="banner">
<div class="hero-badge">Chapter 11</div>
<h1>E-mail and Social Media Investigations</h1>
<p>Tracing, recovering, and analyzing e-mail messages and applying digital forensics methods to social media communications.</p>
</header>

<div class="progress-container" role="navigation" aria-label="Progress"><div class="progress-bar-wrap" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><div class="progress-bar" id="progressBar"></div></div><span class="progress-text" id="progressText">0%</span><button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">&#x1F319;</button></div>

<nav class="nav-bar" aria-label="Lesson sections">
<button class="nav-btn active" data-section="objectives">&#x1F3AF; Objectives</button>
<button class="nav-btn" data-section="content">&#x1F4D6; Lesson</button>
<button class="nav-btn" data-section="activities">&#x1F9E9; Activities</button>
<button class="nav-btn" data-section="flashcards">&#x1F0CF; Flashcards</button>
<button class="nav-btn" data-section="quiz">&#x2705; Quiz</button>
<button class="nav-btn" data-section="glossary">&#x1F4DA; Glossary</button>
<button class="nav-btn" data-section="videos">&#x1F3AC; Videos</button>
</nav>

<main class="container" id="main">

<div class="section active" id="objectives" role="region" aria-label="Learning Objectives">
<h2><span class="icon">&#x1F3AF;</span> Learning Objectives</h2>
<p class="section-sub">After completing this chapter, you will be able to:</p>
<div class="obj-grid">
<div class="obj-card"><div class="obj-num">1</div><div class="obj-text">Explain the role of e-mail in investigations, including phishing, pharming, and spoofing scams.</div></div>
<div class="obj-card"><div class="obj-num">2</div><div class="obj-text">Describe client and server roles in e-mail, including protocols such as SMTP, POP3, and IMAP4.</div></div>
<div class="obj-card"><div class="obj-num">3</div><div class="obj-text">Describe tasks in investigating e-mail crimes and violations, including examining headers and tracing messages.</div></div>
<div class="obj-card"><div class="obj-num">4</div><div class="obj-text">Explain the use of e-mail server logs on both UNIX and Microsoft Exchange systems.</div></div>
<div class="obj-card"><div class="obj-num">5</div><div class="obj-text">Describe specialized e-mail forensics tools and techniques for recovering deleted e-mail.</div></div>
<div class="obj-card"><div class="obj-num">6</div><div class="obj-text">Explain how to apply digital forensics methods to investigating social media communications.</div></div>
</div>
</div>

<div class="section" id="content" role="region" aria-label="Lesson Content">
<h2><span class="icon">&#x1F4D6;</span> Lesson Content</h2>
<p class="section-sub">Expand each section to study the material. Open all sections to maximize your progress.</p>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>1. Exploring the Role of E-mail in Investigations</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>With the increase in e-mail scams and fraud attempts, investigators need to know how to <strong>examine and interpret the unique content of e-mail messages</strong>. E-mail has become a primary means of communication and a major source of digital evidence.</p><h3>Common E-mail Scam Techniques</h3><table class="compare-tbl" role="table"><thead><tr><th>Scam Type</th><th>Description</th><th>Detection Clue</th></tr></thead><tbody><tr><td>Phishing</td><td>Spam e-mail soliciting personal identity information for identity theft. The 419 (Nigerian Scam) is a well-known example.</td><td>Links in e-mail point to fake websites; suspicious sender addresses</td></tr><tr><td>Pharming</td><td>DNS poisoning takes the user to a fake site even when they type the correct Web address.</td><td>View the HTML source code to check for redirect links</td></tr><tr><td>Spoofing</td><td>Altering e-mail header information to make it appear the message came from a different sender.</td><td>Check the ESMTP number in the message header for legitimacy</td></tr></tbody></table><p>Investigators can use the <span class="kt">Enhanced/Extended Simple Mail Transfer Protocol (ESMTP)</span> number in a message&rsquo;s header to check whether an e-mail is legitimate. Every transmitted e-mail gets a unique, nonrepeatable ESMTP number.</p><div class="info-box"><strong>Key Concept:</strong> E-mail fraud relies on deception. Phishing uses fake links, pharming redirects through DNS poisoning, and spoofing forges the sender identity. Investigators must examine both the visible content and the underlying technical headers to uncover the truth.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>2. Client and Server Roles in E-mail</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>E-mail operates in a <span class="kt">client/server architecture</span> and can be sent and received in two environments: the <strong>Internet</strong> and an <strong>intranet</strong> (internal network). The server OS and e-mail software differs from those on the client side, and accounts are protected with usernames and passwords.</p><h3>How E-mail Client/Server Works</h3><p>A Windows server runs an e-mail server program, such as <strong>Microsoft Exchange Server</strong>, to provide e-mail services. Client computers use e-mail programs like <strong>Microsoft Outlook</strong> to contact the server. Users access their e-mail based on permissions the administrator grants.</p><h3>E-mail Protocols</h3><table class="compare-tbl" role="table"><thead><tr><th>Protocol</th><th>Function</th><th>Details</th></tr></thead><tbody><tr><td>SMTP</td><td>Sending e-mail between servers</td><td>Simple Mail Transfer Protocol; the backbone of e-mail delivery</td></tr><tr><td>POP3</td><td>Retrieving e-mail from server</td><td>Post Office Protocol v3; downloads mail to client and typically deletes from server</td></tr><tr><td>IMAP4</td><td>Retrieving e-mail from server</td><td>Internet Message Access Protocol 4; slowly replacing POP3; keeps mail on server</td></tr><tr><td>MAPI</td><td>Microsoft e-mail integration</td><td>Messaging Application Programming Interface; lets Microsoft e-mail apps work together</td></tr></tbody></table><h3>E-mail Name Conventions</h3><p>Corporate environments typically use formats like <strong>Jane.Smith@somecompany.com</strong>, while public environments use formats like <strong>itty_bitty@gmail.com</strong>. For investigators, tracking intranet e-mail is easier because accounts use standard names established by the administrator. However, cloud computing adds complexity.</p><div class="info-box"><strong>Forensic Tip:</strong> Understanding e-mail protocols is crucial because each protocol leaves different forensic artifacts. POP3 typically downloads and deletes messages from the server, while IMAP4 keeps messages on the server &mdash; affecting where you can recover evidence.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>3. Investigating E-mail Crimes and Violations</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>Investigating crimes or policy violations involving e-mail is similar to investigating other types of computer abuse and crimes. The goals are to <strong>find who is behind the crime</strong>, <strong>collect the evidence</strong>, <strong>present findings</strong>, and <strong>build a case</strong>.</p><h3>Legal Framework</h3><p>Investigators should know privacy laws for the jurisdiction. The <span class="kt">Electronic Communications Privacy Act (ECPA)</span> was enacted in 1986 to extend the Wiretap Act to cover e-mail. The <span class="kt">Stored Communications Act (SCA)</span> extends privacy protections to stored communications like e-mail.</p><h3>Forensic Linguistics</h3><p><span class="kt">Forensic linguistics</span> is a related field where language and law intersect. It trains professionals to analyze voice recordings to determine speakers, or read e-mails to determine if a specific person authored them. It is divided into four categories: language and law, language and the legal process, language as evidence, and research/teaching.</p><h3>Examining E-mail Messages</h3><p>When investigating, use the <strong>victim&rsquo;s computer</strong> to retrieve evidence. If you cannot access the victim&rsquo;s computer, guide the victim over the phone. For suspect computers, know how to deal with deleted e-mails. Always <strong>copy and print</strong> the e-mail message involved in the crime.</p><div class="info-box warn"><strong>Important:</strong> What constitutes a crime or policy violation involving e-mail depends on the city, state, or country in which the e-mail originated. Always verify the applicable privacy laws for the jurisdiction before proceeding with evidence collection.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>4. Viewing and Examining E-mail Headers</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>E-mail headers contain critical forensic information. The main piece of evidence you&rsquo;re looking for is the <strong>originating e-mail&rsquo;s IP address</strong>, along with the date and time sent, attachment filenames, and unique message numbers.</p><h3>Information Found in E-mail Headers</h3><table class="compare-tbl" role="table"><thead><tr><th>Header Field</th><th>Forensic Value</th></tr></thead><tbody><tr><td>Return Path</td><td>Shows the reply-to address; may differ from visible sender</td></tr><tr><td>Received: lines</td><td>Trace the route the e-mail traveled between servers</td></tr><tr><td>IP Address</td><td>Identifies the originating server; key for tracing the sender</td></tr><tr><td>ESMTP ID</td><td>Unique message number for verification</td></tr><tr><td>Date/Time</td><td>When the e-mail was sent; useful for establishing timelines</td></tr><tr><td>Content-Type/MIME</td><td>Identifies attachment types and encoding</td></tr></tbody></table><h3>Tracing an E-mail Message</h3><p>To track down a suspect, use the information from the e-mail header. Sites like <strong>www.arin.net</strong>, <strong>www.internic.com</strong>, and Google can help find the contact point of the originating domain name. Always <strong>verify findings with network logs</strong> since the suspect might have posted fake information.</p><h3>Additional E-mail Files</h3><p>Microsoft Outlook saves e-mails in <span class="kt">.pst</span> and <span class="kt">.ost</span> files. Web-based e-mails are saved as Web pages in the browser&rsquo;s cache folders. The <strong>personal address book</strong> is another valuable source of information.</p><div class="info-box"><strong>Forensic Tip:</strong> To search for specific files in e-mail headers, use a forensics tool such as FTK. Forensics tools can also search for unique header information like an ESMTP ID number, making it easier to correlate messages across systems.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>5. Understanding E-mail Servers and Logs</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>An e-mail server is loaded with software that uses e-mail protocols for its services and <strong>maintains logs</strong> you can examine in your investigation. E-mail servers store messages using either a <strong>database</strong> or a <strong>flat file system</strong>.</p><h3>E-mail Server Logs</h3><p>Some servers log e-mail transactions by default; others must be configured. Logs can work in <strong>continuous</strong> or <strong>circular</strong> mode. Circular mode saves server storage space but overwrites information that cannot be recovered. Logs generally identify: messages received, sending IP address, date/time stamps, e-mail content, and system-specific information.</p><h3>UNIX E-mail Server Logs</h3><table class="compare-tbl" role="table"><thead><tr><th>File Path</th><th>Purpose</th></tr></thead><tbody><tr><td>/etc/mail/sendmail.cf</td><td>Configuration file for Sendmail</td></tr><tr><td>/etc/syslog.conf</td><td>Specifies how and which events Sendmail logs</td></tr><tr><td>/var/log/maillog</td><td>Records SMTP, POP3, and IMAP4 communications with IP and timestamps</td></tr><tr><td>/etc/postfix/master.cf</td><td>Configuration file for Postfix</td></tr></tbody></table><p>UNIX systems store log files in <strong>/var/log</strong> by default, but administrators can change the location. Use the <span class="kt">find</span> or <span class="kt">locate</span> command to find them.</p><h3>Microsoft Exchange Server Logs</h3><p><span class="kt">Microsoft Exchange Server</span> is a database e-mail server based on the <strong>Extensible Storage Engine (ESE)</strong>. The most useful files are <strong>.edb database files</strong>, checkpoint files, and temporary files. Key log types include: transaction logs, checkpoints, e-mail communication logs, tracking logs, and troubleshooting/diagnostic logs.</p><p>Use the Windows PowerShell cmdlet <span class="kt">GetTransactionLogStats.ps1 -Gather</span> to retrieve Exchange log files. The <strong>Tracking.log</strong> tracks messages through Exchange, and <strong>Windows Event Viewer</strong> can read troubleshooting logs.</p><div class="info-box warn"><strong>Critical:</strong> Contact the suspect&rsquo;s network or e-mail administrator as soon as the e-mail source is identified. Deleted e-mails can be recovered from a server using processes similar to recovering deleted files on a hard drive, but logs may be overwritten if action isn&rsquo;t taken quickly.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>6. Specialized E-mail Forensics Tools</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p>Specialized tools make it possible to recover e-mail evidence without needing to know how the e-mail server or client operates. These tools can find <strong>e-mail database files</strong>, <strong>personal e-mail files</strong>, <strong>offline storage files</strong>, and <strong>log files</strong>.</p><h3>E-mail Investigation Tools</h3><table class="compare-tbl" role="table"><thead><tr><th>Tool</th><th>Capability</th></tr></thead><tbody><tr><td>Magnet AXIOM</td><td>Combines evidence retrieval from PCs, mobile devices, and the cloud</td></tr><tr><td>AccessData FTK</td><td>Internet keyword search, e-mail recovery, and header analysis</td></tr><tr><td>Paraben E-Mail Examiner</td><td>Dedicated e-mail analysis and recovery</td></tr><tr><td>MailXaminer</td><td>E-mail forensics and analysis across multiple formats</td></tr><tr><td>DataNumen</td><td>Recovery for Outlook and Outlook Express</td></tr><tr><td>MXToolBox</td><td>E-mail diagnostics and header analysis</td></tr></tbody></table><h3>Using a Hex Editor to Carve E-mail</h3><p>The <span class="kt">mbox</span> format stores e-mails in flat plaintext files. The <span class="kt">MIME</span> (Multipurpose Internet Mail Extensions) format is used by vendor-specific e-mail file systems like Microsoft .pst or .ost. For mbox-format e-mails, a hexadecimal editor can manually carve messages.</p><h3>Recovering Outlook Files</h3><p>Tools like Magnet AXIOM, OSForensics, X-Ways Forensics, FTK, and EnCase can reconstruct .pst files. Microsoft&rsquo;s <span class="kt">scanpst.exe</span> recovery tool can repair both .ost and .pst files.</p><div class="info-box"><strong>Best Practice:</strong> After comparing e-mail logs with messages, verify the e-mail account, message ID, IP address, and date/time stamp to determine whether there&rsquo;s enough evidence for a warrant. Document every step in the investigation process.</div></div></div></div>

<div class="acc-item"><button class="acc-hd" aria-expanded="false"><span>7. Applying Digital Forensics to Social Media</span><span class="chv" aria-hidden="true">&#x25BC;</span></button><div class="acc-bd"><div class="acc-ct"><p><span class="kt">Online social networks (OSNs)</span> can be used to build a profile of a prospective client, business partner, or suspect. Social media can provide evidence of cyberbullying, witness tampering, intellectual property violations, and more.</p><h3>Types of Social Media Evidence</h3><p>Investigators can find: evidence of <strong>cyberbullying and witness tampering</strong>, a company&rsquo;s position on an issue, whether <strong>intellectual property rights</strong> have been violated, and <strong>who posted information and when</strong>.</p><h3>Legal Considerations</h3><p>OSNs involve <strong>multiple jurisdictions</strong> that might cross national boundaries. Investigators must obtain a <strong>warrant or subpoena</strong> to get information from social networks such as Facebook, Twitter, and other OSNs.</p><h3>Social Media Forensics on Mobile Devices</h3><p>The majority of social media users access networks through <strong>mobile devices</strong>. Evidence artifacts vary depending on the social media channel and the device. On iPhones, SQLite databases for Facebook list friends, ID numbers, and phone numbers. Android devices synchronize Facebook friends into the contacts list. Both platforms store much of this data in <span class="kt">SQLite databases</span>.</p><h3>Forensic Tools for Social Media</h3><p>While software for social media forensics is still developing, many forensics suites now have <strong>built-in social media tools</strong>. Some OSN tools use customized Web crawlers but may be too slow for efficiency. Questions remain about how information gathered by these tools can be used in court.</p><div class="info-box"><strong>Key Concept:</strong> Social media forensics is an evolving science. The Enron case demonstrated the challenges of e-mail investigations at scale, and modern social media investigations present similar challenges with the added complexity of mobile devices and cross-jurisdictional data.</div></div></div></div>
</div>

<div class="section" id="activities" role="region" aria-label="Interactive Activities"><h2><span class="icon">&#x1F9E9;</span> Interactive Activities</h2><p class="section-sub">Practice what you&rsquo;ve learned with hands-on exercises.</p>
<div class="tab-row" role="tablist"><button class="tab-btn active" data-tab="matching" role="tab">Term Matching</button><button class="tab-btn" data-tab="sorting" role="tab">Step Sorting</button><button class="tab-btn" data-tab="truefalse" role="tab">True / False</button><button class="tab-btn" data-tab="scenario" role="tab">Scenario</button></div>
<div class="tab-panel active" id="tab-matching"><h3>Match the Term to Its Definition</h3><p style="color:var(--tx2);margin-bottom:16px">Click a term on the left, then click its matching definition on the right.</p><div class="match-container"><div><div class="match-col-title">Terms</div><div id="matchTerms"></div></div><div><div class="match-col-title">Definitions</div><div id="matchDefs"></div></div></div><div class="match-score" id="matchScore">Matched: 0 / 6</div><div style="text-align:center;margin-top:12px"><button class="btn sec" id="matchReset">Reset</button></div></div>
<div class="tab-panel" id="tab-sorting"><h3>Sort the E-mail Investigation Steps</h3><p style="color:var(--tx2);margin-bottom:16px">Drag and drop these steps into the correct order for investigating an e-mail crime.</p><ul class="sort-list" id="sortList" role="list"></ul><div style="text-align:center;margin-top:16px"><button class="btn pri" id="sortCheck">Check Order</button><button class="btn sec" id="sortReset" style="margin-left:8px">Reset</button></div><div id="sortFeedback" style="text-align:center;margin-top:16px;font-weight:600"></div></div>
<div class="tab-panel" id="tab-truefalse"><h3>True or False &mdash; Rapid Fire</h3><p style="color:var(--tx2);margin-bottom:16px">Test your knowledge quickly!</p><div id="tfContainer"></div><div id="tfScore" style="text-align:center;margin-top:20px;font-family:var(--fM);color:var(--tx2)"></div></div>
<div class="tab-panel" id="tab-scenario"><h3>E-mail Investigation Scenario</h3><p style="color:var(--tx2);margin-bottom:16px">You are a forensic examiner investigating a phishing scheme targeting your company. Make the right decisions!</p><div class="sg-box" id="sgBox"><div class="sg-progress-dots" id="sgDots"></div><div class="sg-lbl" id="sgLabel">Scenario</div><div class="sg-text" id="sgText"></div><div class="sg-choices" id="sgChoices"></div><div class="sg-feedback" id="sgFeedback" style="display:none"></div><div style="text-align:center;margin-top:16px"><button class="btn pri" id="sgNext" style="display:none">Continue &rarr;</button></div></div><div id="sgResult" style="display:none;text-align:center;padding:20px"></div></div>
</div>

<div class="section" id="flashcards" role="region" aria-label="Flashcards"><h2><span class="icon">&#x1F0CF;</span> 3D Flashcards</h2><p class="section-sub">Click the card to rotate through three faces: Term &rarr; Definition &rarr; Example. Use arrow keys to navigate between cards.</p><div class="fc-stats"><span id="fcCounter">Card 1 of 15</span><span id="fcScore"></span></div>
<div class="fc-dots" id="fcDots"><div class="fc-dot-grp active" data-face="0"><button class="fc-dot a-term" aria-label="Show term" data-face="0"></button><span class="fc-dot-lbl">Term</span></div><div class="fc-dot-grp" data-face="1"><button class="fc-dot" aria-label="Show definition" data-face="1"></button><span class="fc-dot-lbl">Definition</span></div><div class="fc-dot-grp" data-face="2"><button class="fc-dot" aria-label="Show example" data-face="2"></button><span class="fc-dot-lbl">Example</span></div></div>
<div class="fc-viewport" id="fcViewport" tabindex="0" role="button" aria-label="3D Flashcard &mdash; click or press Enter to rotate">
<div class="fc-prism" id="fcPrism">
<div class="fc-face fc-face--term"><div class="fc-lbl"><span class="fc-lbl-icon">&#x1F4CC;</span> Term</div><div class="fc-main" id="fcTerm"></div><div class="fc-hint">Click to see definition &rarr;</div></div>
<div class="fc-face fc-face--def"><div class="fc-lbl"><span class="fc-lbl-icon">&#x1F4D6;</span> Definition</div><div class="fc-main" id="fcDef"></div></div>
<div class="fc-face fc-face--example"><div class="fc-lbl"><span class="fc-lbl-icon">&#x1F4A1;</span> Example</div><div class="fc-main" id="fcEx"></div></div>
</div></div>
<div class="fc-ctrls"><button class="fc-btn" id="fcPrev">&larr; Previous</button><button class="fc-btn flip" id="fcFlip">Rotate Card &#x21BB;</button><button class="fc-btn pri" id="fcNext">Next &rarr;</button></div></div>

<div class="section" id="quiz" role="region" aria-label="Knowledge Quiz"><h2><span class="icon">&#x2705;</span> Knowledge Check</h2><p class="section-sub">Test your understanding with review questions.</p><div class="card"><div id="quizArea"><div class="quiz-progress" id="quizProgress"></div><div class="quiz-q" id="quizQ"></div><div class="quiz-opts" id="quizOpts" role="radiogroup"></div><div class="quiz-fb" id="quizFb"></div><div class="btn-row"><button class="btn pri" id="quizSubmit">Check Answer</button><button class="btn sec" id="quizNext" style="display:none">Next Question &rarr;</button></div></div><div id="quizResults" style="display:none;text-align:center;padding:40px 20px"><div class="score-circle"><span class="score-num" id="finalScore"></span><span class="score-lbl">correct</span></div><h3 id="scoreMsg"></h3><p style="color:var(--tx2);margin:12px 0 24px">Review the lesson and try again to improve.</p><button class="btn pri" id="quizRestart">Restart Quiz</button></div></div></div>

<div class="section" id="glossary" role="region" aria-label="Glossary"><h2><span class="icon">&#x1F4DA;</span> Key Terms Glossary</h2><p class="section-sub">Search or browse key terms from this chapter.</p><input type="text" class="glo-search" id="gloSearch" placeholder="Search terms..." aria-label="Search glossary"><div id="gloList"></div></div>

<div class="section" id="videos" role="region" aria-label="Related Videos"><h2><span class="icon">&#x1F3AC;</span> Related Videos</h2><p class="section-sub">Curated videos to reinforce your learning.</p><div class="vid-grid">
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/ORyPLiNPeiY" title="How Email Works" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">How Email Works &mdash; SMTP, POP3, IMAP (PowerCert)</div><div class="vid-desc">Animated breakdown of how e-mail protocols work together to send, receive, and store messages.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/2GpNhYy2l08" title="How to Read Email Headers" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">How to Read Email Headers (Hashed Out)</div><div class="vid-desc">Walkthrough of reading and interpreting e-mail headers to trace message origins and detect spoofing.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/XjCGk0DMBD0" title="Email Forensics" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">Email Forensics &mdash; Digital Forensics Investigation</div><div class="vid-desc">Overview of how forensic investigators analyze e-mail as evidence, including header analysis and metadata extraction.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/inWWhr5tnEA" title="What is Phishing" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">What is Phishing? (Cisco)</div><div class="vid-desc">Explains phishing attack methods, how to recognize phishing e-mails, and defense strategies.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/4G_RRbKyfBg" title="Social Media Forensics" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">Social Media Digital Forensics (DFIR Science)</div><div class="vid-desc">How investigators collect and analyze evidence from social media platforms and mobile devices.</div></div></div>
<div class="vid-card"><iframe class="vid-embed" src="https://www.youtube.com/embed/0QN7l-JRpMI" title="Email Spoofing Explained" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe><div class="vid-info"><div class="vid-title">Email Spoofing &mdash; How It Works (ThioJoe)</div><div class="vid-desc">Demonstrates how e-mail spoofing works and why ESMTP and header analysis are critical for detection.</div></div></div>
</div></div>

</main>
<script>
const flashcards=[
{term:"Phishing",def:"A type of e-mail scam typically sent as spam soliciting personal identity information that fraudsters can use for identity theft. The 419 (Nigerian Scam) is one of the most well-known examples.",ex:"An employee receives an e-mail appearing to be from their bank, requesting they verify their account details via a link. The forensic investigator examines the e-mail header and finds the message originated from an IP address in Eastern Europe, not the bank\u2019s mail server. The link in the HTML source redirects to a fake website designed to harvest credentials."},
{term:"Pharming",def:"A type of e-mail scam where DNS poisoning takes users to a fake website even when they type the correct address. Unlike phishing, users don\u2019t need to click a link \u2014 the redirection happens at the DNS level.",ex:"A company\u2019s HR department reports that employees entering the benefits portal URL are being redirected to a look-alike site collecting login credentials. The investigator views the HTML source code of the suspicious redirect and discovers DNS poisoning has altered the domain resolution, sending users to a server controlled by the attacker."},
{term:"Spoofing",def:"Altering an e-mail message\u2019s header information so that its point of origin appears to be from a different sender. Also referred to as forged e-mail. Typically used in phishing and spamming to hide the sender\u2019s identity.",ex:"An employee receives a threatening e-mail that appears to come from a coworker. The forensic examiner views the full headers and discovers the ESMTP number doesn\u2019t match the company\u2019s mail server. Tracing the originating IP through ARIN reveals the message was sent from a public Wi-Fi hotspot across town."},
{term:"ESMTP",def:"Enhanced/Extended Simple Mail Transfer Protocol \u2014 an enhancement of SMTP that generates a unique, nonrepeatable number added to each transmitted e-mail. No two messages from an e-mail server have the same ESMTP value, making it valuable for verification.",ex:"During a fraud investigation, the examiner compares the ESMTP numbers in two suspicious e-mails. Both claim to be from the same corporate mail server, but one has an ESMTP ID format that doesn\u2019t match the server\u2019s known pattern, confirming it was spoofed from an external source."},
{term:"Client/Server Architecture",def:"A network architecture in which each computer or process on the network is either a client or server. In e-mail, servers handle message routing and storage while clients provide the user interface for reading and composing messages.",ex:"The investigator maps the company\u2019s e-mail infrastructure: a Microsoft Exchange Server handles all routing and stores messages in .edb databases, while 200 employees use Outlook clients to send and receive mail. By imaging both the server and a suspect\u2019s client machine, the investigator recovers both the server-side logs and locally cached .pst files."},
{term:"SMTP",def:"Simple Mail Transfer Protocol \u2014 the protocol used for sending e-mail messages between servers. SMTP handles the transmission of outgoing mail from the sender\u2019s server to the recipient\u2019s server.",ex:"An investigator examining UNIX server logs at /var/log/maillog finds SMTP transaction records showing the exact time a threatening e-mail was relayed through the company\u2019s mail server, including the sender\u2019s IP address and the recipient\u2019s domain."},
{term:"POP3",def:"Post Office Protocol version 3 \u2014 a protocol for retrieving e-mail messages from a server. POP3 typically downloads mail to the client and removes it from the server, which can complicate forensic recovery.",ex:"An employee\u2019s Outlook is configured with POP3, meaning all e-mails were downloaded to the local machine and deleted from the server. The investigator must focus on the local .pst file rather than the server to recover the deleted evidence, using scanpst.exe to repair any corruption."},
{term:"IMAP4",def:"Internet Message Access Protocol version 4 \u2014 a protocol for retrieving e-mail messages that is slowly replacing POP3. Unlike POP3, IMAP4 keeps messages on the server, providing investigators with a server-side copy of e-mail evidence.",ex:"Because the suspect used IMAP4, the investigator contacts the e-mail administrator and obtains server-side copies of all messages, including ones the suspect deleted from their client. The server\u2019s retention policy kept deleted messages for 30 days, providing a complete evidence trail."},
{term:"E-mail Header",def:"The technical metadata of an e-mail message containing routing information, IP addresses, timestamps, server names, and unique message identifiers. Headers are the primary source for tracing an e-mail\u2019s origin.",ex:"The investigator opens the full headers of a harassing e-mail and reads them bottom-to-top. Line 1 shows the Return-Path, lines 2\u20136 show \u2018Received:\u2019 hops with IP addresses and timestamps, and the DKIM signature helps verify the sending domain. The originating IP is traced through ARIN to an ISP in another state."},
{term:"mbox",def:"A method of storing e-mail messages in a flat plaintext file. Used by some UNIX/Linux e-mail clients. Because it is plaintext, a hex editor can be used to manually carve individual messages from an mbox file.",ex:"During a Linux workstation examination, the investigator discovers the suspect used the Evolution e-mail client. E-mails are stored in mbox format. Using a hex editor, the examiner manually carves three deleted messages that contain incriminating communications about the data theft."},
{term:"MIME",def:"Multipurpose Internet Mail Extensions \u2014 a specification for formatting non-ASCII messages such as graphics, audio, and video for transmission over the Internet. Vendor-specific e-mail systems like Microsoft .pst and .ost use MIME encoding.",ex:"An investigator analyzing a phishing campaign notices the e-mails contain MIME-encoded attachments. By decoding the MIME content, the examiner discovers a hidden executable disguised as a PDF invoice \u2014 the malware payload used in the attack."},
{term:"Electronic Communications Privacy Act (ECPA)",def:"A law enacted in 1986 to extend the Wiretap Act to cover e-mail and other data transmitted via the Internet. Establishes legal protections for electronic communications.",ex:"Before obtaining e-mail records from the suspect\u2019s ISP, the prosecutor ensures the warrant complies with ECPA requirements. The defense challenges the evidence, but the judge rules the warrant was properly obtained under ECPA provisions, and the e-mail logs are admitted."},
{term:"Forensic Linguistics",def:"A field where language and law intersect, divided into four categories: language and law, language and the legal process, language as evidence, and research/teaching. Used to determine authorship of e-mails and other written communications.",ex:"In a harassment case, the suspect denies writing the threatening e-mails. A forensic linguist compares the writing style \u2014 sentence structure, vocabulary, and punctuation patterns \u2014 in the threats with the suspect\u2019s known work e-mails. The analysis identifies 14 distinctive linguistic markers matching the suspect\u2019s writing habits."},
{term:"Online Social Networks (OSNs)",def:"The research term for social media platforms. OSNs can provide forensic evidence including cyberbullying, witness tampering, intellectual property violations, and timestamped user activity.",ex:"During a workplace harassment investigation, the examiner obtains a subpoena for the suspect\u2019s Facebook account. The preserved data includes private messages with timestamps showing the suspect contacted the victim 47 times in one week, GPS-tagged posts placing the suspect near the victim\u2019s home, and photos corroborating witness statements."},
{term:"Stored Communications Act (SCA)",def:"Part of the Electronic Communications Privacy Act that extends privacy protections specifically to stored communications such as e-mail messages, providing legal standards for law enforcement access to stored electronic communications.",ex:"The investigator needs access to stored e-mails on a cloud provider\u2019s servers. Under the SCA, certain stored communications require a warrant rather than just a subpoena. The legal team works with the prosecutor to obtain the proper court order before requesting the data from the provider."}
];
const quizData=[
{q:"What is phishing?",opts:["Altering e-mail headers to hide the sender\u2019s identity","DNS poisoning that redirects users to fake websites","A scam e-mail soliciting personal identity information for fraud","A technique for recovering deleted e-mails"],ans:2,exp:"Phishing is a type of e-mail scam typically sent as spam that solicits personal identity information, which fraudsters use for identity theft. The 419 (Nigerian Scam) is one of the most well-known examples."},
{q:"What protocol is used to send e-mail messages between servers?",opts:["POP3","IMAP4","MAPI","SMTP"],ans:3,exp:"SMTP (Simple Mail Transfer Protocol) is the protocol used for sending e-mail messages between servers. POP3 and IMAP4 are used for retrieving e-mail from servers."},
{q:"What is the main piece of information investigators look for in e-mail headers?",opts:["The subject line of the message","The originating e-mail\u2019s IP address","The recipient\u2019s phone number","The e-mail client version"],ans:1,exp:"The main piece of information investigators look for in e-mail headers is the originating e-mail\u2019s IP address, along with date/time stamps, attachment filenames, and unique message numbers."},
{q:"Which Microsoft Outlook file formats store e-mail data?",opts:[".doc and .xls files",".edb and .log files",".pst and .ost files",".mbox and .mime files"],ans:2,exp:"Microsoft Outlook saves e-mail data in .pst (Personal Storage Table) and .ost (Offline Storage Table) files. The .edb files are associated with Exchange Server databases, and .mbox is a UNIX format."},
{q:"What does the ESMTP number help investigators determine?",opts:["The physical location of the sender","Whether an e-mail is legitimate since each message gets a unique number","The size of e-mail attachments","How many times an e-mail was forwarded"],ans:1,exp:"ESMTP generates a unique, nonrepeatable number added to each transmitted e-mail. No two messages from an e-mail server have the same ESMTP value, making it valuable for verifying e-mail legitimacy."},
{q:"Where are UNIX e-mail server log files stored by default?",opts:["/etc/mail/","C:\\Windows\\Logs\\","/var/log/","/usr/local/logs/"],ans:2,exp:"UNIX systems store log files in the /var/log directory by default. The /var/log/maillog file records SMTP, POP3, and IMAP4 communications. Administrators can change the location, so use the find or locate command."},
{q:"What is the Stored Communications Act (SCA)?",opts:["A protocol for encrypting stored e-mails","Part of the ECPA that extends privacy protections to stored communications like e-mail","A tool for recovering deleted e-mail messages","A standard for storing forensic images"],ans:1,exp:"The Stored Communications Act (SCA) is part of the Electronic Communications Privacy Act that extends privacy protections specifically to stored communications such as e-mail messages."},
{q:"Which format stores e-mail in flat plaintext files?",opts:[".pst",".ost","mbox",".edb"],ans:2,exp:"The mbox format stores e-mail messages in flat plaintext files. Because it is plaintext, a hex editor can be used to manually carve individual messages. It is commonly used by UNIX/Linux e-mail clients."},
{q:"What must investigators obtain to access social media data from platforms like Facebook?",opts:["Only verbal permission from the account holder","A warrant or subpoena","A request through the social media platform\u2019s help page","Nothing \u2014 social media data is publicly available"],ans:1,exp:"Investigators must obtain a warrant or subpoena to get information from social networks such as Facebook, Twitter, and other OSNs. OSN investigations may involve multiple jurisdictions crossing national boundaries."},
{q:"What database format is commonly used by social media apps on iPhones and Android devices?",opts:["Microsoft Access","MySQL","SQLite","Oracle"],ans:2,exp:"Forensic analysis showed that iPhones and Android devices store social media data primarily in SQLite databases. On iPhones, a SQLite database for Facebook lists friends, ID numbers, and phone numbers."}
];
const matchData=[
{term:"Phishing",def:"Scam e-mail soliciting personal identity information"},
{term:"Spoofing",def:"Altering e-mail headers to fake the sender\u2019s identity"},
{term:"SMTP",def:"Protocol for sending e-mail between servers"},
{term:"IMAP4",def:"Retrieval protocol that keeps messages on the server"},
{term:"mbox",def:"Stores e-mail as flat plaintext files"},
{term:"ECPA",def:"Law extending Wiretap Act to cover e-mail"}
];
const sortSteps=[
"Access the victim\u2019s computer to retrieve evidence",
"Copy and print the e-mail message involved in the crime",
"View the full e-mail headers to find the originating IP address",
"Trace the IP address using ARIN or InterNIC",
"Examine e-mail server logs for corroborating evidence",
"Verify findings with network router and firewall logs",
"Compare e-mail account, message ID, IP, and timestamps",
"Document all steps and determine if there is enough evidence for a warrant"
];
const tfData=[
{s:"SMTP is the protocol used for retrieving e-mail messages from a server.",a:false,exp:"SMTP (Simple Mail Transfer Protocol) is used for sending e-mail between servers. POP3 and IMAP4 are the protocols used for retrieving e-mail messages from a server."},
{s:"The ESMTP number in an e-mail header is unique and nonrepeatable, making it useful for verifying message authenticity.",a:true,exp:"ESMTP generates a unique, nonrepeatable number that\u2019s added to each transmitted e-mail. No two messages from an e-mail server have the same ESMTP value."},
{s:"POP3 keeps e-mail messages on the server after downloading them to the client.",a:false,exp:"POP3 typically downloads messages to the client and removes them from the server. IMAP4 is the protocol that keeps messages on the server, which is why it\u2019s slowly replacing POP3."},
{s:"Microsoft Outlook stores e-mail data in .pst and .ost files.",a:true,exp:"Microsoft Outlook uses .pst (Personal Storage Table) files for personal e-mail storage and .ost (Offline Storage Table) files for offline access to Exchange mailboxes."},
{s:"Pharming uses fake links in e-mails to trick users into visiting malicious websites.",a:false,exp:"That describes phishing. Pharming uses DNS poisoning to redirect users to fake sites even when they type the correct Web address \u2014 no link clicking is required."},
{s:"Forensic linguistics can be used to determine whether a specific person authored an e-mail.",a:true,exp:"Forensic linguistics is a field where language and law intersect, training professionals to analyze writing style, vocabulary, and patterns to determine authorship of e-mails and other communications."},
{s:"UNIX e-mail server logs are always stored in /var/log and the location cannot be changed.",a:false,exp:"While /var/log is the default location for UNIX log files, an administrator can change the log location. Investigators should use the find or locate command to find log files."},
{s:"Investigators must obtain a warrant or subpoena to access social media account data from platforms like Facebook.",a:true,exp:"Because OSNs involve multiple jurisdictions and privacy protections, investigators must obtain a warrant or subpoena to get information from social networks."}
];
const scenarioData=[
{text:"Multiple employees report receiving suspicious e-mails that appear to come from the CEO, asking them to wire funds to a new account. What is your first step as the forensic investigator?",choices:[
{t:"Immediately delete all the suspicious e-mails to prevent more employees from falling for the scam",rating:"bad",fb:"Deleting the e-mails destroys critical evidence. You need to preserve the messages, including their full headers, for forensic analysis."},
{t:"Instruct employees to preserve the e-mails, then obtain copies with full headers to examine the originating IP address and ESMTP numbers",rating:"best",fb:"Correct! Preserving the evidence is the first priority. Full headers contain the IP address, ESMTP numbers, and routing information needed to trace the e-mail\u2019s true origin."},
{t:"Send a reply to the suspicious e-mail to see who responds",rating:"bad",fb:"Replying to a phishing/spoofing e-mail alerts the attacker and could expose more information. Evidence should be examined forensically, not through direct engagement."}]},
{text:"You\u2019ve obtained the full e-mail headers. The \u2018From\u2019 field shows the CEO\u2019s address, but you suspect spoofing. How do you confirm?",choices:[
{t:"Check if the subject line matches the CEO\u2019s usual writing style",rating:"okay",fb:"Writing style can be a clue, but it\u2019s not definitive. The ESMTP number and originating IP in the headers provide much stronger technical evidence of spoofing."},
{t:"Examine the ESMTP number and trace the originating IP address in the Received headers to see if they match the company\u2019s mail server",rating:"best",fb:"Excellent! The ESMTP number is unique per server. If it doesn\u2019t match the company\u2019s Exchange server pattern, and the IP address traces to an external source, the e-mail is confirmed as spoofed."},
{t:"Call the CEO and ask if they sent it",rating:"okay",fb:"While confirming with the CEO is helpful, forensic evidence from headers provides definitive proof. The CEO might be unavailable, and technical analysis should proceed regardless."}]},
{text:"The originating IP address traces to another country. You need to examine the company\u2019s e-mail server logs for more evidence. The company runs Microsoft Exchange. Where do you look?",choices:[
{t:"Check the Tracking.log and .edb database files on the Exchange server, and use Event Viewer for diagnostic logs",rating:"best",fb:"Perfect! Exchange\u2019s Tracking.log records message routing, .edb files contain the mail database, and Event Viewer provides diagnostic information. You can also use GetTransactionLogStats.ps1 for transaction logs."},
{t:"Look in /var/log/maillog on the server",rating:"bad",fb:"/var/log/maillog is a UNIX/Linux log file location. Since the company runs Microsoft Exchange, you need to examine Exchange-specific files like .edb databases, Tracking.log, and Event Viewer logs."},
{t:"Search the entire server for any file with \u2018email\u2019 in the name",rating:"okay",fb:"A broad file search might find some results, but it\u2019s not systematic. Knowing exactly where Exchange stores its logs (.edb files, Tracking.log, Event Viewer) is much more efficient and thorough."}]},
{text:"During the investigation, you discover the attacker also contacted employees via social media. You need to gather evidence from their Facebook profiles. What\u2019s the proper approach?",choices:[
{t:"Log into the suspect\u2019s Facebook account using credentials found on their computer",rating:"bad",fb:"Accessing someone\u2019s account without authorization is illegal and could make any evidence inadmissible. Proper legal process must be followed."},
{t:"Obtain a warrant or subpoena for the social media data, then work with the platform to preserve and collect evidence",rating:"best",fb:"Correct! Investigators must obtain a warrant or subpoena to access social media data. OSN investigations involve legal considerations, and working with the platform ensures proper chain of custody."},
{t:"Take screenshots of the suspect\u2019s public posts from your own account",rating:"okay",fb:"Screenshots of public posts can supplement your evidence, but they don\u2019t capture private messages, metadata, or deleted content. A proper legal request to the platform provides much more comprehensive evidence."}]},
{text:"You\u2019ve gathered substantial evidence: spoofed e-mail headers, Exchange server logs, and social media records. How do you prepare your findings?",choices:[
{t:"Verbally summarize your findings to the legal team without formal documentation",rating:"bad",fb:"Verbal summaries are insufficient for legal proceedings. Every step must be documented with proper chain of custody, and evidence must be formally presented."},
{t:"Document every step taken, verify e-mail accounts and message IDs against server logs, create hash values for all evidence files, and prepare a formal report",rating:"best",fb:"Excellent! Thorough documentation is essential. Verifying account details, message IDs, IP addresses, and timestamps against logs ensures the evidence is corroborated, and hash values maintain integrity."},
{t:"Upload all evidence files to a shared cloud drive and send the link to the legal team",rating:"bad",fb:"Uploading evidence to an unsecured cloud drive breaks chain of custody and could compromise evidence integrity. Proper forensic procedures require controlled evidence handling and hash verification."}]}
];
const glossaryData=[
{term:"Phishing",def:"A type of e-mail scam typically sent as spam soliciting personal identity information for identity theft. The 419 (Nigerian Scam) is a well-known example."},
{term:"Pharming",def:"A type of e-mail scam where DNS poisoning takes users to a fake website even when they type the correct address."},
{term:"Spoofing",def:"Altering an e-mail message\u2019s header information so the point of origin appears to be from a different sender. Also called forged e-mail."},
{term:"Simple Mail Transfer Protocol (SMTP)",def:"A protocol for sending e-mail messages between servers. The backbone of e-mail delivery."},
{term:"Post Office Protocol version 3 (POP3)",def:"A protocol for retrieving e-mail messages from a server. Typically downloads mail to the client and removes it from the server."},
{term:"Internet Message Access Protocol 4 (IMAP4)",def:"A protocol for retrieving e-mail messages that keeps messages on the server. Slowly replacing POP3."},
{term:"Enhanced/Extended Simple Mail Transfer Protocol (ESMTP)",def:"An enhancement of SMTP that generates a unique, nonrepeatable number added to each transmitted e-mail for verification."},
{term:"Messaging Application Programming Interface (MAPI)",def:"The Microsoft system that enables different e-mail applications to work with each other."},
{term:"Client/Server Architecture",def:"A network architecture where clients request services from a server. In e-mail, servers handle routing/storage while clients provide the user interface."},
{term:"Electronic Communications Privacy Act (ECPA)",def:"A law enacted in 1986 to extend the Wiretap Act to cover e-mail and other data transmitted via the Internet."},
{term:"Stored Communications Act (SCA)",def:"Part of the ECPA that extends privacy protections to stored communications such as e-mail messages."},
{term:"Forensic Linguistics",def:"A field where language and law intersect, used to determine authorship of e-mails and other communications. Divided into four categories."},
{term:"E-mail Header",def:"Technical metadata containing routing information, IP addresses, timestamps, server names, and unique message identifiers used to trace message origins."},
{term:"mbox",def:"A method of storing e-mail messages in a flat plaintext file. Can be manually carved with a hex editor."},
{term:"Multipurpose Internet Mail Extensions (MIME)",def:"A specification for formatting non-ASCII messages (graphics, audio, video) for Internet transmission."},
{term:"Online Social Networks (OSNs)",def:"The research term for social media platforms. Can provide evidence of cyberbullying, witness tampering, IP violations, and timestamped user activity."},
{term:"Microsoft Exchange Server",def:"A database e-mail server based on Microsoft Extensible Storage Engine (ESE). Key files include .edb databases, checkpoint files, and tracking logs."},
{term:"scanpst.exe",def:"Microsoft\u2019s recovery tool for repairing corrupted .pst and .ost Outlook files."},
{term:".pst File",def:"Personal Storage Table \u2014 Microsoft Outlook\u2019s file format for storing e-mail messages, contacts, and calendar data locally."},
{term:".ost File",def:"Offline Storage Table \u2014 Microsoft Outlook\u2019s file format for offline access to Exchange Server mailbox data."},
{term:"SQLite Database",def:"A lightweight database format commonly used by social media apps on mobile devices to store user data, friend lists, and uploaded content."}
];

// NAV
const navBtns=document.querySelectorAll('.nav-btn');const sections=document.querySelectorAll('.section');
navBtns.forEach(b=>b.addEventListener('click',()=>{navBtns.forEach(n=>n.classList.remove('active'));b.classList.add('active');sections.forEach(s=>s.classList.remove('active'));document.getElementById(b.dataset.section).classList.add('active');updProg()}));
// TABS
document.querySelectorAll('.tab-btn').forEach(b=>b.addEventListener('click',()=>{document.querySelectorAll('.tab-btn').forEach(t=>t.classList.remove('active'));b.classList.add('active');document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));document.getElementById('tab-'+b.dataset.tab).classList.add('active')}));
// ACCORDION
document.querySelectorAll('.acc-hd').forEach(b=>b.addEventListener('click',()=>{const it=b.parentElement;const bd=b.nextElementSibling;const open=it.classList.toggle('open');b.setAttribute('aria-expanded',open);bd.style.maxHeight=open?bd.scrollHeight+'px':'0';setTimeout(updProg,400)}));
// THEME
const tt=document.getElementById('themeToggle');function setTh(d){document.documentElement.setAttribute('data-theme',d?'dark':'');tt.textContent=d?'\u2600\uFE0F':'\uD83C\uDF19';localStorage.setItem('ch11theme',d?'dark':'')}tt.addEventListener('click',()=>setTh(document.documentElement.getAttribute('data-theme')!=='dark'));if(localStorage.getItem('ch11theme')==='dark')setTh(true);
// PROGRESS
function updProg(){const v=new Set();navBtns.forEach(b=>{if(b.classList.contains('active'))v.add(b.dataset.section)});const opened=document.querySelectorAll('.acc-item.open').length;const total=document.querySelectorAll('.acc-item').length;const base=14;const accP=total?Math.round((opened/total)*50):0;const navP=Math.round((v.size/7)*50);const p=Math.min(100,base+accP+navP);document.getElementById('progressBar').style.width=p+'%';document.getElementById('progressText').textContent=p+'%'}
// FLASHCARDS
let fcIdx=0,fcFace=0;
function showFC(){const c=flashcards[fcIdx];document.getElementById('fcTerm').textContent=c.term;document.getElementById('fcDef').textContent=c.def;document.getElementById('fcEx').innerHTML='<em class="fc-ex-pre">Real-World Scenario:</em>'+c.ex;document.getElementById('fcCounter').textContent=`Card ${fcIdx+1} of ${flashcards.length}`;fcFace=0;updPrism();updDots()}
function updPrism(){document.getElementById('fcPrism').style.transform=`rotateX(${fcFace*120}deg)`}
function updDots(){document.querySelectorAll('.fc-dot-grp').forEach((g,i)=>{g.classList.toggle('active',i===fcFace);const d=g.querySelector('.fc-dot');d.className='fc-dot'+(i===fcFace?i===0?' a-term':i===1?' a-def':' a-ex':'')})}
document.getElementById('fcViewport').addEventListener('click',()=>{fcFace=(fcFace+1)%3;updPrism();updDots()});
document.getElementById('fcViewport').addEventListener('keydown',e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();fcFace=(fcFace+1)%3;updPrism();updDots()}});
document.getElementById('fcFlip').addEventListener('click',()=>{fcFace=(fcFace+1)%3;updPrism();updDots()});
document.getElementById('fcPrev').addEventListener('click',()=>{fcIdx=(fcIdx-1+flashcards.length)%flashcards.length;showFC()});
document.getElementById('fcNext').addEventListener('click',()=>{fcIdx=(fcIdx+1)%flashcards.length;showFC()});
document.querySelectorAll('.fc-dot').forEach(d=>d.addEventListener('click',()=>{fcFace=parseInt(d.dataset.face);updPrism();updDots()}));
document.addEventListener('keydown',e=>{if(document.getElementById('flashcards').classList.contains('active')){if(e.key==='ArrowLeft'){fcIdx=(fcIdx-1+flashcards.length)%flashcards.length;showFC()}else if(e.key==='ArrowRight'){fcIdx=(fcIdx+1)%flashcards.length;showFC()}}});
showFC();

// QUIZ
let qIdx=0,qAns=-1,qScore=0,qAnswered=false;
function showQ(){const q=quizData[qIdx];document.getElementById('quizProgress').textContent=`Question ${qIdx+1} of ${quizData.length}`;document.getElementById('quizQ').textContent=q.q;const oc=document.getElementById('quizOpts');oc.innerHTML='';qAns=-1;qAnswered=false;document.getElementById('quizFb').textContent='';document.getElementById('quizFb').className='quiz-fb';document.getElementById('quizSubmit').style.display='';document.getElementById('quizNext').style.display='none';q.opts.forEach((o,i)=>{const d=document.createElement('div');d.className='quiz-opt';d.setAttribute('role','radio');d.setAttribute('aria-checked','false');d.innerHTML=`<span class="ltr">${String.fromCharCode(65+i)}</span><span>${o}</span>`;d.addEventListener('click',()=>{if(qAnswered)return;document.querySelectorAll('.quiz-opt').forEach(x=>{x.classList.remove('selected');x.setAttribute('aria-checked','false')});d.classList.add('selected');d.setAttribute('aria-checked','true');qAns=i});oc.appendChild(d)})}
document.getElementById('quizSubmit').addEventListener('click',()=>{if(qAns===-1||qAnswered)return;qAnswered=true;const q=quizData[qIdx];const opts=document.querySelectorAll('.quiz-opt');opts[q.ans].classList.add('correct');if(qAns===q.ans){qScore++;document.getElementById('quizFb').className='quiz-fb ok';document.getElementById('quizFb').textContent='\u2714 Correct! '+q.exp}else{opts[qAns].classList.add('incorrect');document.getElementById('quizFb').className='quiz-fb no';document.getElementById('quizFb').textContent='\u2718 Incorrect. '+q.exp}document.getElementById('quizSubmit').style.display='none';document.getElementById('quizNext').style.display=''});
document.getElementById('quizNext').addEventListener('click',()=>{qIdx++;if(qIdx>=quizData.length){document.getElementById('quizArea').style.display='none';const r=document.getElementById('quizResults');r.style.display='';document.getElementById('finalScore').textContent=qScore+'/'+quizData.length;document.getElementById('scoreMsg').textContent=qScore>=quizData.length*.8?'Excellent work!':qScore>=quizData.length*.6?'Good job!':'Keep studying!'}else showQ()});
document.getElementById('quizRestart').addEventListener('click',()=>{qIdx=0;qScore=0;document.getElementById('quizArea').style.display='';document.getElementById('quizResults').style.display='none';showQ()});showQ();

// MATCHING
let mSelTerm=null,mSelDef=null,mMatched=0;
function initMatch(){mSelTerm=null;mSelDef=null;mMatched=0;const tc=document.getElementById('matchTerms'),dc=document.getElementById('matchDefs');tc.innerHTML='';dc.innerHTML='';const si=[...Array(matchData.length).keys()].sort(()=>Math.random()-.5);matchData.forEach((m,i)=>{const d=document.createElement('div');d.className='match-item';d.textContent=m.term;d.addEventListener('click',()=>pickTerm(d,i));tc.appendChild(d)});si.forEach(i=>{const d=document.createElement('div');d.className='match-item';d.textContent=matchData[i].def;d.dataset.origIdx=i;d.addEventListener('click',()=>pickDef(d,i));dc.appendChild(d)});document.getElementById('matchScore').textContent=`Matched: 0 / ${matchData.length}`}
function pickTerm(el,i){if(el.classList.contains('matched'))return;document.querySelectorAll('#matchTerms .match-item').forEach(e=>e.classList.remove('sel'));el.classList.add('sel');mSelTerm=i;if(mSelDef!==null)checkMatch()}
function pickDef(el,i){if(el.classList.contains('matched'))return;document.querySelectorAll('#matchDefs .match-item').forEach(e=>e.classList.remove('sel'));el.classList.add('sel');mSelDef=i;if(mSelTerm!==null)checkMatch()}
function checkMatch(){if(mSelTerm===mSelDef){document.querySelectorAll('#matchTerms .match-item')[mSelTerm].classList.add('matched');document.querySelectorAll('#matchTerms .match-item')[mSelTerm].classList.remove('sel');document.querySelectorAll('#matchDefs .match-item').forEach(e=>{if(parseInt(e.dataset.origIdx)===mSelDef){e.classList.add('matched');e.classList.remove('sel')}});mMatched++;document.getElementById('matchScore').textContent=mMatched===matchData.length?'\u{1F389} All matched! Great work!':`Matched: ${mMatched} / ${matchData.length}`}else{document.querySelectorAll('.match-item.sel').forEach(e=>{e.classList.add('wrong');e.classList.remove('sel');setTimeout(()=>e.classList.remove('wrong'),500)})}mSelTerm=null;mSelDef=null}
document.getElementById('matchReset').addEventListener('click',initMatch);initMatch();

// SORTING
function initSort(){const ul=document.getElementById('sortList');ul.innerHTML='';const sh=[...sortSteps].sort(()=>Math.random()-.5);sh.forEach((s,i)=>{const li=document.createElement('li');li.className='sort-item';li.draggable=true;li.innerHTML=`<span class="grip" aria-hidden="true">&#x283F;</span><span class="s-num">${i+1}</span><span>${s}</span>`;li.addEventListener('dragstart',()=>li.classList.add('dragging'));li.addEventListener('dragend',()=>{li.classList.remove('dragging');updSN()});li.addEventListener('dragover',e=>{e.preventDefault();li.classList.add('over')});li.addEventListener('dragleave',()=>li.classList.remove('over'));li.addEventListener('drop',e=>{e.preventDefault();li.classList.remove('over');const dr=ul.querySelector('.dragging');if(dr&&dr!==li)ul.insertBefore(dr,li)});ul.appendChild(li)});document.getElementById('sortFeedback').textContent='';document.querySelectorAll('.sort-item').forEach(i=>i.classList.remove('correct-pos','wrong-pos'))}
function updSN(){document.querySelectorAll('.sort-item .s-num').forEach((n,i)=>n.textContent=i+1)}
document.getElementById('sortCheck').addEventListener('click',()=>{const items=document.querySelectorAll('.sort-item');let c=0;items.forEach((it,i)=>{const t=it.querySelector('span:last-child').textContent;if(t===sortSteps[i]){it.classList.add('correct-pos');it.classList.remove('wrong-pos');c++}else{it.classList.add('wrong-pos');it.classList.remove('correct-pos')}});document.getElementById('sortFeedback').style.color=c===sortSteps.length?'var(--ok)':'var(--hi)';document.getElementById('sortFeedback').textContent=c===sortSteps.length?'\u{1F389} Perfect order!':c+' of '+sortSteps.length+' correct. Keep trying!'});
document.getElementById('sortReset').addEventListener('click',initSort);initSort();

// TRUE/FALSE
let tfA=0,tfC=0;function initTF(){tfA=0;tfC=0;const c=document.getElementById('tfContainer');c.innerHTML='';tfData.forEach((q,i)=>{const d=document.createElement('div');d.className='tf-card';d.id='tf-'+i;d.innerHTML=`<div class="tf-statement">${q.s}</div><div class="tf-btns"><button class="tf-btn" data-i="${i}" data-a="true">\u2714 True</button><button class="tf-btn" data-i="${i}" data-a="false">\u2718 False</button></div><div class="tf-result" id="tf-r-${i}"></div>`;c.appendChild(d)});document.querySelectorAll('.tf-btn').forEach(b=>b.addEventListener('click',hTF));updTFS()}
function hTF(e){const i=parseInt(e.target.dataset.i),ans=e.target.dataset.a==='true',q=tfData[i],card=document.getElementById('tf-'+i),r=document.getElementById('tf-r-'+i);if(card.classList.contains('answered-true')||card.classList.contains('answered-false'))return;tfA++;const ok=ans===q.a;if(ok)tfC++;card.classList.add(ok?'answered-true':'answered-false');card.querySelectorAll('.tf-btn').forEach(b=>b.disabled=true);r.className='tf-result '+(ok?'ok':'no');r.textContent=(ok?'\u2714 Correct! ':'\u2718 Incorrect. ')+q.exp;updTFS()}
function updTFS(){document.getElementById('tfScore').textContent=tfA?`Score: ${tfC} / ${tfA} correct`:'Answer each statement to test your knowledge.'}initTF();

// SCENARIO
let sgS=0,sgSc=0;function initSG(){sgS=0;sgSc=0;document.getElementById('sgResult').style.display='none';document.getElementById('sgBox').style.display='';showSGS()}
function showSGS(){const s=scenarioData[sgS],dots=document.getElementById('sgDots');dots.innerHTML='';scenarioData.forEach((_,i)=>{const d=document.createElement('div');d.className='sg-dot'+(i<sgS?' done':'')+(i===sgS?' active':'');dots.appendChild(d)});document.getElementById('sgLabel').textContent=`Step ${sgS+1} of ${scenarioData.length}`;document.getElementById('sgText').textContent=s.text;const cc=document.getElementById('sgChoices');cc.innerHTML='';cc.style.display='';s.choices.forEach((ch,i)=>{const d=document.createElement('div');d.className='sg-choice';d.textContent=ch.t;d.addEventListener('click',()=>sgP(i));cc.appendChild(d)});document.getElementById('sgFeedback').style.display='none';document.getElementById('sgNext').style.display='none'}
function sgP(i){const s=scenarioData[sgS],ch=s.choices[i];document.querySelectorAll('.sg-choice').forEach((c,x)=>{c.style.pointerEvents='none';c.classList.add(s.choices[x].rating)});if(ch.rating==='best')sgSc+=2;else if(ch.rating==='okay')sgSc+=1;const fb=document.getElementById('sgFeedback');fb.style.display='block';fb.style.background=ch.rating==='best'?'rgba(45,106,79,.1)':ch.rating==='okay'?'rgba(233,196,106,.15)':'rgba(196,69,54,.1)';fb.style.color=ch.rating==='best'?'var(--ok)':ch.rating==='okay'?'#8B6914':'var(--hi)';fb.textContent=(ch.rating==='best'?'\u2714 Best choice! ':ch.rating==='okay'?'\u26A0 Acceptable, but not ideal. ':'\u2718 Not recommended. ')+ch.fb;document.getElementById('sgNext').style.display=''}
document.getElementById('sgNext').addEventListener('click',()=>{sgS++;if(sgS>=scenarioData.length){const r=document.getElementById('sgResult');r.style.display='';r.innerHTML=`<div class="score-circle"><span class="score-num">${sgSc}/${scenarioData.length*2}</span><span class="score-lbl">points</span></div><h3>${sgSc>=scenarioData.length*1.5?'Excellent investigator!':sgSc>=scenarioData.length?'Good instincts!':'Needs more practice.'}</h3><p style="color:var(--tx2);margin:12px 0 20px">Review the e-mail and social media investigation procedures in the lesson.</p><button class="btn pri" onclick="initSG()">Try Again</button>`;document.getElementById('sgBox').style.display='none'}else showSGS()});initSG();

// GLOSSARY
function renderGlo(f=''){const l=document.getElementById('gloList');l.innerHTML='';const fl=glossaryData.filter(g=>g.term.toLowerCase().includes(f.toLowerCase())||g.def.toLowerCase().includes(f.toLowerCase()));if(!fl.length){l.innerHTML='<p style="color:var(--tx2);padding:20px;text-align:center">No matching terms.</p>';return}fl.forEach(g=>{const d=document.createElement('div');d.className='glo-item';d.innerHTML=`<div class="glo-term">${g.term}</div><div class="glo-def">${g.def}</div>`;l.appendChild(d)})}
document.getElementById('gloSearch').addEventListener('input',e=>renderGlo(e.target.value));renderGlo();updProg();
</script>
</body>
</html>
